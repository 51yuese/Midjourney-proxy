
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,u as a,r as l,E as t,A as o,q as s,j as r,V as i,o as d,c as u,b as n,f as p,l as c,m as g,g as m,h as f,w as b,e as y,I as v,t as h,N as w,Z as x,P as _,O as F,s as V,_ as k,n as z}from"../main-c47e4581.js";import{u as C}from"../utcformatTime/utcformatTime.f6db2c52.js";const N={style:{"padding-bottom":"32px"}},U={class:"search_condition"},j={style:{display:"flex","align-items":"center"}},A={style:{"margin-left":"12px"}},I={style:{"margin-top":"22px","margin-left":"12px"}},D={style:{"margin-top":"22px"}},q={style:{"margin-top":"12px"}},M={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},P={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},B={style:{display:"flex","align-items":"center","justify-content":"space-between"}},E={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},Y=e({__name:"classify",setup(e){const k=a();l();const z=l(0),Y=l(!1),L=l(!1);l("/api/file/upload");const R=t({groupName:"",status:1,page:1,size:10}),K=l(),O=l(0),S=t({groupName:"",weight:1,status:0}),T=t({groupName:[{required:!0,message:"请填写分类名称",trigger:"blur"}],weight:[{required:!1,message:"请填写排序ID",trigger:"blur"}],status:[{required:!0,message:"请选择分类状态",trigger:"change"}]}),Z=l([]),G=o((()=>O.value?"更新分类":"新增分类"));async function H(){try{L.value=!0;const e=await x.queryCats(R),{rows:a,count:l}=e.data;L.value=!1,z.value=l,Z.value=a}catch(e){L.value=!1}}function J(e){O.value=0,Y.value=!1,null==e||e.resetFields()}function Q(){R.groupName="",R.status=1,R.page=1,R.size=10,H()}function W(){S.groupName="",S.groupLogo="",S.weight=1,S.status=0,Y.value=!0}return o((()=>O.value?"确认更新":"确认新增")),s((()=>{H()})),(e,a)=>{const l=r("el-alert"),t=r("el-input"),o=r("el-option"),s=r("el-select"),X=r("el-button"),$=r("RefreshRight"),ee=r("el-icon"),ae=r("el-table-column"),le=r("el-tag"),te=r("el-popconfirm"),oe=r("el-table"),se=r("el-pagination"),re=r("el-row"),ie=V,de=r("el-form-item"),ue=r("el-switch"),ne=r("el-form"),pe=r("el-dialog"),ce=i("loading");return d(),u("div",null,[n("div",N,[p(l,{closable:!1,"show-icon":"",title:"应用分类说明",description:"你创建的为系统内置分类、可能会被多个用户收藏、一旦创建、不建议删除、系统或限制已经创建的应用、请合理规范应用以免造成不必要的迷惑。",type:"warning"})]),n("div",U,[n("div",j,[n("div",null,[a[11]||(a[11]=n("div",{class:"search_title"},"分类名称",-1)),n("div",null,[p(t,{modelValue:R.groupName,"onUpdate:modelValue":a[0]||(a[0]=e=>R.groupName=e),placeholder:"分类名称[模糊搜索]",onKeydown:c(g(H,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"])])]),n("div",A,[a[12]||(a[12]=n("div",{class:"search_title"},"分类状态",-1)),n("div",null,[p(s,{modelValue:R.status,"onUpdate:modelValue":a[1]||(a[1]=e=>R.status=e),placeholder:"请选择分类状态",clearable:"",style:{width:"192px"}},{default:m((()=>[p(o,{label:"启用",value:1}),p(o,{label:"禁用",value:0})])),_:1},8,["modelValue"])])]),n("div",I,[p(X,{text:"",bg:"",style:{"font-size":"15px",color:"#60A5FA","background-color":"#EFF6FF","border-radius":"8px"},onClick:H},{default:m((()=>a[13]||(a[13]=[f("查询 ")]))),_:1})]),n("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:Q},[p(ee,{color:"#3B82F6",size:"20"},{default:m((()=>[p($)])),_:1})])]),n("div",D,[p(X,{style:{"background-color":"transparent",border:"1px solid #3B82F6","border-radius":"8px",color:"#3B82F6"},onClick:W},{default:m((()=>a[14]||(a[14]=[f("创建分类 ")]))),_:1})])]),n("div",q,[b((d(),v(oe,{border:"",data:y(Z),height:"60vh",style:{width:"100%"},size:"large"},{default:m((()=>[p(ae,{prop:"weight",label:"排序ID",width:"120"}),p(ae,{prop:"groupName",label:"名称",width:"120"}),p(ae,{prop:"status",label:"状态",width:"120"},{default:m((e=>[p(le,{type:1===e.row.status?"primary":"danger"},{default:m((()=>[f(h(1===e.row.status?"启用":"禁用"),1)])),_:2},1032,["type"])])),_:1}),p(ae,{prop:"createdAt",label:"创建时间"},{default:m((e=>[f(h(y(C)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),p(ae,{label:"操作",width:"200"},{default:m((e=>[p(X,{link:"",type:"primary",size:"small",onClick:a=>function(e){O.value=e.id;const{groupName:a,status:l,weight:t,groupLogo:o}=e;_((()=>{Object.assign(S,{groupName:a,status:l,weight:t,groupLogo:o})})),Y.value=!0}(e.row)},{default:m((()=>a[15]||(a[15]=[f(" 编辑 ")]))),_:2},1032,["onClick"]),p(te,{title:"确认删除此分类么?",width:"200","icon-color":"red",onConfirm:a=>async function(e){if(0==k.isUserModifyPermissions())return F.error("非超级管理员无权限操作！");await x.deleteCats({id:e.id}),F.success("删除分类成功"),H()}(e.row)},{reference:m((()=>[p(X,{link:"",type:"danger",size:"small"},{default:m((()=>a[16]||(a[16]=[f(" 删除分类 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[ce,y(L)]]),p(re,{class:"flex justify-end mt-5"},{default:m((()=>[p(se,{"current-page":R.page,"onUpdate:currentPage":a[2]||(a[2]=e=>R.page=e),"page-size":R.size,"onUpdate:pageSize":a[3]||(a[3]=e=>R.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:y(z),onSizeChange:H,onCurrentChange:H},null,8,["current-page","page-size","total"])])),_:1})]),p(pe,{modelValue:y(Y),"onUpdate:modelValue":a[10]||(a[10]=e=>w(Y)?Y.value=e:null),width:"650","show-close":!1,"destroy-on-close":""},{header:m((({close:e,titleId:l,titleClass:t})=>[n("div",M,[n("div",null,h(y(G)),1),n("div",{onClick:a[4]||(a[4]=e=>J(y(K))),style:{cursor:"pointer"}},[p(ee,null,{default:m((()=>[p(ie,{name:"close"})])),_:1})])])])),default:m((()=>[n("div",P,[p(ne,{ref_key:"formPackageRef",ref:K,"label-position":"right","label-width":"100px",model:S,rules:T},{default:m((()=>[n("div",B,[p(de,{label:"分类名称",prop:"groupName"},{default:m((()=>[p(t,{size:"large",modelValue:S.groupName,"onUpdate:modelValue":a[5]||(a[5]=e=>S.groupName=e),placeholder:"请填写分类名称"},null,8,["modelValue"])])),_:1}),p(de,{label:"排序ID",prop:"weight"},{default:m((()=>[p(t,{size:"large",modelValue:S.weight,"onUpdate:modelValue":a[6]||(a[6]=e=>S.weight=e),modelModifiers:{number:!0},placeholder:"请填写排序ID[数字越大越靠前]"},null,8,["modelValue"])])),_:1})]),p(de,{label:"分类状态",prop:"status"},{default:m((()=>[p(ue,{modelValue:S.status,"onUpdate:modelValue":a[7]||(a[7]=e=>S.status=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])]),n("div",E,[p(X,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:a[8]||(a[8]=e=>J(y(K)))},{default:m((()=>a[17]||(a[17]=[f("取消 ")]))),_:1}),p(X,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:a[9]||(a[9]=e=>{var a;null==(a=y(K))||a.validate((async e=>{if(e){if(0==k.isUserModifyPermissions())return F.error("非超级管理员无权限操作！");O.value?(await x.updateCats({id:O.value,...S}),F({type:"success",message:"更新套餐成功！"})):(await x.createCats(S),F({type:"success",message:"创建新的套餐成功！"})),Y.value=!1,H()}}))})},{default:m((()=>a[18]||(a[18]=[f(" 确定 ")]))),_:1})])])),_:1},8,["modelValue"])])}}});"function"==typeof z&&z(Y);const L=k(Y,[["__scopeId","data-v-1fb50b8d"]]);export{L as default};
