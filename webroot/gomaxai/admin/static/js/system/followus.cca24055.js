
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{a}from"../config/config.e980ec46.js";import{a as e}from"./system.0104ca8f.js";import{d as r,u as l,G as t,r as o,x as s,j as i,o as n,c,f as g,g as m,e as u,ab as p,J as d,b as f,h as w,P as h,p as b,k as y,_,q as v}from"../main-5b9099dc.js";const I=(a=>(b("data-v-512b4ab4"),a=a(),y(),a))((()=>f("div",{style:{color:"#20295A","font-size":"15px","margin-bottom":"24px"}},"联系我们",-1))),x=["src"],P=["src"],k={style:{"margin-top":"16px"}},M=r({__name:"followus",setup(r){const b=l(),y=t({wechatImage:"",weMiniProgramImage:"",chatOnline:""}),_=o({wechatImage:[{required:!0,trigger:"blur",message:"微信公众号二维码"}],weMiniProgramImage:[{required:!0,trigger:"blur",message:"微信小程序二维码"}],chatOnline:[{required:!0,trigger:"blur",message:"在线客服地址"}]}),v=o();async function M(){const e=await a.queryConfig({keys:["wechatImage","weMiniProgramImage","chatOnline"]});Object.assign(y,e.data)}function j(){var e;null==(e=v.value)||e.validate((async e=>{if(e){if(0==b.isUserModifyPermissions())return h.error("非超级管理员无权限操作！");try{await a.setConfig({settings:(r=y,Object.keys(r).map((a=>({configKey:a,configVal:r[a]}))))}),h.success("变更二维码成功")}catch(l){}M()}else h.error("请填写完整信息");var r}))}const O=(a,r)=>{const l=a.name.split(".")[1],t=new FormData;t.append("filename",a.raw.uid+"."+l),t.append("file",a.raw),t.append("dir","follow-upload"),e.uploadFile(t).then((a=>{const e=a.data;"wechat"===r&&(y.wechatImage=e),"miniProgram"===r&&(y.weMiniProgramImage=e)}))},F=a=>"image/jpeg"!==a.type&&"image/png"!==a.type?(h.error("只支持jpg和png格式"),!1):!(a.size/1024/1024>2)||(h.error("图片不能大于2M!"),!1);return s((()=>{M()})),(a,e)=>{const r=i("Plus"),l=i("el-icon"),t=i("el-form-item"),o=i("el-input"),s=i("el-col"),h=i("el-row"),b=i("el-form"),M=i("el-button");return n(),c("div",null,[I,g(b,{ref_key:"formRef",ref:v,rules:_.value,model:y,"label-position":"top"},{default:m((()=>[g(h,null,{default:m((()=>[g(s,{xs:24,md:20,lg:15,xl:8},{default:m((()=>[g(t,{label:"客服二维码",prop:"wechatImage"},{default:m((()=>[g(u(p),{class:"avatar-uploader",action:"","auto-upload":!1,"show-file-list":!1,onChange:e[0]||(e[0]=a=>O(a,"wechat")),"before-upload":F},{default:m((()=>[y.wechatImage?(n(),c("img",{key:0,src:y.wechatImage,class:"avatar"},null,8,x)):(n(),d(l,{key:1,class:"avatar-uploader-icon"},{default:m((()=>[g(r)])),_:1}))])),_:1})])),_:1}),g(t,{label:"公众号二维码",prop:"weMiniProgramImage"},{default:m((()=>[g(u(p),{class:"avatar-uploader",action:"","auto-upload":!1,"show-file-list":!1,onChange:e[1]||(e[1]=a=>O(a,"miniProgram")),"before-upload":F},{default:m((()=>[y.weMiniProgramImage?(n(),c("img",{key:0,src:y.weMiniProgramImage,class:"avatar"},null,8,P)):(n(),d(l,{key:1,class:"avatar-uploader-icon"},{default:m((()=>[g(r)])),_:1}))])),_:1})])),_:1}),g(t,{label:"在线客服地址",prop:"chatOnline"},{default:m((()=>[g(o,{size:"large",modelValue:y.chatOnline,"onUpdate:modelValue":e[2]||(e[2]=a=>y.chatOnline=a)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["rules","model"]),f("div",k,[g(M,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:j},{default:m((()=>[w("保存设置")])),_:1})])])}}});"function"==typeof v&&v(M);const j=_(M,[["__scopeId","data-v-512b4ab4"]]);export{j as default};
