
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{ac as e,d as l,ax as a,C as u,o as t,J as r,ay as o,e as i,az as s,u as n,r as d,D as m,x as p,j as c,c as f,b as y,f as v,g,h,t as b,K as w,P as x,y as _,_ as I,q as V}from"../main-5b9099dc.js";const C=l=>e.get("menu/query",{params:l}),T=l=>e.post("menu/visible",l),k=l=>e.post("menu/setMenu",l),U=l=>e.post("menu/delete",l),P=l({__name:"index",props:{icon:{}},setup(e){const l=a(),n=u((()=>({class:l.class||"",style:l.style||"width: 2em, height: 2em"})));return(e,l)=>(t(),r(i(s),o({icon:e.icon},n.value),null,16,["icon"]))}}),S={style:{"margin-top":"10px"}},N={style:{"text-align":"right"}},F={style:{"margin-top":"12px"}},q={key:0},j={class:"flex items-center"},z={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},A={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},J={style:{display:"flex","align-items":"center","justify-content":"space-between"}},B={style:{display:"flex","align-items":"center","justify-content":"space-between"}},D=["src"],M={style:{display:"flex","align-items":"center"}},G={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},O=l({__name:"menu",setup(e){const l=n(),a=d(1),o=d(),s=d(!1),I=d(0);d(""),d(""),d(0),d(!1);const V=d("/api/file/upload"),O=d({menuTipText:"",menuName:"",menuIframeUrl:"",isJump:!1,isShow:!0,menuIcon:"",menuCover:"",menuPath:"",order:1e3,isNeedAuth:!1,isSystem:!0}),E={menuName:[{required:!0,trigger:"blur",message:"请填写菜单名称"}],menuTipText:[{required:!0,trigger:"blur",message:"请填写菜单描述"}],menuIframeUrl:[{required:!0,trigger:"blur",message:"请填写三方网页地址"}],isJump:[{required:!0,trigger:"blur",message:"请确认是否跳转"}],isShow:[{required:!0,trigger:"blur",message:"请确认是否打开菜单"}],menuIcon:[{required:!0,trigger:"blur",message:"请填写ICON图标"}],order:[{required:!0,trigger:"blur",message:"请填写排序ID"}],menuPath:[{required:!0,trigger:"blur",message:"请填写菜单路径"}],isSystem:[{required:!0,trigger:"blur",message:"请确认是否是系统内地址"}],isNeedAuth:[{required:!0,trigger:"blur",message:"请确认是否需要权限"}]};m(a,(e=>{H()}));const K=u((()=>I.value>0?"编辑菜单":"添加菜单")),R=u((()=>I.value>0?"确认修改":"确认添加")),W=d([]);async function H(){const e=await C({menuPlatform:a.value});W.value=e.data}async function L(){I.value="",O.value.menuTipText="",O.value.menuName="",O.value.menuIframeUrl="",O.value.isJump=!1,O.value.isShow=!0,O.value.menuIcon="",O.value.menuCover="",O.value.menuPath="",O.value.order=1e3,O.value.isNeedAuth=!1,O.value.isSystem=!0,s.value=!0}const Q=e=>["image/png","image/jpeg","image/gif","image/webp"].includes(e.type)?e.size/1024>300?(x.error("当前限制文件最大不超过 300KB!"),!1):void 0:(x.error("当前系统仅支持 PNG、JPEG、GIF、和 WebP 格式的图片!"),!1),X=(e,l)=>{O.value.menuCover=e.data};return p((()=>{H()})),(e,u)=>{const n=c("el-alert"),d=c("el-button"),m=c("el-table-column"),p=c("el-tag"),C=c("el-image"),Y=c("el-popconfirm"),Z=c("el-table"),$=_,ee=c("el-icon"),le=c("el-input"),ae=c("el-form-item"),ue=c("Plus"),te=c("el-upload"),re=c("el-switch"),oe=c("el-form"),ie=c("el-dialog");return t(),f("div",null,[y("div",null,[y("div",S,[v(n,{closable:!1,"show-icon":"",title:"动态菜单配置说明",description:"请至少配置一个、如果不配置默认设置对话页面、排序ID越小越靠前、PC和移动端是两套独立的设置、图标选择请在此处： https://icon-sets.iconify.design/ 找到或搜索到喜欢的图标之后可以复制下方的图标编号 例如material-symbols:chat-outline、更加详细文档参考官方演示站公告文档地址！",type:"warning"})]),y("div",N,[v(d,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px","margin-top":"32px"},onClick:L},{default:g((()=>[h(" 添加菜单 ")])),_:1})]),y("div",F,[v(Z,{border:"",data:W.value,style:{width:"100%"}},{default:g((()=>[v(m,{prop:"order",label:"排序ID",width:"100"}),v(m,{prop:"menuName",label:"菜单名称"},{default:g((e=>[y("p",null,b(e.row.menuName),1)])),_:1}),v(m,{prop:"menuType",label:"菜单类型"},{default:g((e=>[v(p,{type:e.row.menuType?"success":"danger"},{default:g((()=>[h(b(0===e.row.menuType?"系统预设":"自定义菜单"),1)])),_:2},1032,["type"])])),_:1}),v(m,{prop:"isShow",label:"是否显示菜单"},{default:g((e=>[v(p,{type:e.row.isShow?"primary":"info"},{default:g((()=>[h(b(e.row.isShow?"是":"否"),1)])),_:2},1032,["type"])])),_:1}),v(m,{prop:"menuIcon",label:"菜单图标"},{default:g((e=>[v(P,{style:{"font-size":"24px"},icon:e.row.menuIcon},null,8,["icon"])])),_:1}),v(m,{prop:"menuCover",label:"菜单封面"},{default:g((e=>[null==e.row.menuCover?(t(),f("div",q,"--")):(t(),r(C,{key:1,style:{height:"40px"},src:e.row.menuCover,fit:"fill"},null,8,["src"]))])),_:1}),v(m,{prop:"menuPath",label:"菜单路径"},{default:g((e=>[h(b(e.row.menuPath||"---"),1)])),_:1}),v(m,{prop:"menuIframeUrl",label:"三方网页链接"},{default:g((e=>[h(b(e.row.menuIframeUrl||"---"),1)])),_:1}),v(m,{prop:"menuTipText",label:"菜单描述"},{default:g((e=>[h(b(e.row.menuTipText||"---"),1)])),_:1}),v(m,{label:"操作",fixed:"right",width:"150"},{default:g((e=>[y("div",j,[v(d,{link:"",type:"primary",onClick:l=>function(e){const{id:l,menuTipText:a,menuName:u,menuIframeUrl:t,isJump:r,isShow:o,menuIcon:i,menuCover:n,menuPath:d,order:m,isNeedAuth:p}=e;I.value=l,O.value={menuName:u,menuTipText:a,menuIframeUrl:t,isJump:r,isShow:o,menuIcon:i,menuCover:n,menuPath:d,order:m,isNeedAuth:p,isSystem:!d},s.value=!0}(e.row),size:"small"},{default:g((()=>[h("编辑菜单 ")])),_:2},1032,["onClick"]),e.row.menuType?w("",!0):(t(),r(d,{key:0,link:"",onClick:a=>async function(e){if(0==l.isUserModifyPermissions())return x.error("非超级管理员无权限操作！");const{id:a}=e;await T({id:a}),x.success("操作成功！"),H()}(e.row),type:e.row.isShow?"danger":"primary",size:"small"},{default:g((()=>[h(b(e.row.isShow?"隐藏菜单":"打开菜单"),1)])),_:2},1032,["onClick","type"])),e.row.menuType?(t(),r(Y,{key:1,title:"是否删除当前菜单？",onConfirm:a=>async function(e){if(0==l.isUserModifyPermissions())return x.error("非超级管理员无权限操作！");await U({id:e.id}),x.success("操作成功！"),H()}(e.row)},{reference:g((()=>[v(d,{link:"",type:"danger",size:"small"},{default:g((()=>[h("删除菜单")])),_:1})])),_:2},1032,["onConfirm"])):w("",!0)])])),_:1})])),_:1},8,["data"])]),v(ie,{modelValue:s.value,"onUpdate:modelValue":u[11]||(u[11]=e=>s.value=e),width:"800","show-close":!1,"destroy-on-close":""},{header:g((({close:e,titleId:l,titleClass:a})=>[y("div",z,[y("div",null,b(i(K)),1),y("div",{onClick:u[0]||(u[0]=e=>s.value=!1),style:{cursor:"pointer"}},[v(ee,null,{default:g((()=>[v($,{name:"close"})])),_:1})])])])),default:g((()=>[y("div",A,[v(oe,{ref_key:"formRef",ref:o,"label-width":"140",rules:E,model:O.value},{default:g((()=>[y("div",J,[v(ae,{label:"菜单名称",prop:"menuName"},{default:g((()=>[v(le,{modelValue:O.value.menuName,"onUpdate:modelValue":u[1]||(u[1]=e=>O.value.menuName=e),placeholder:"请填写菜单名称",style:{width:"240px"}},null,8,["modelValue"])])),_:1}),v(ae,{label:"菜单图标编号",prop:"menuIcon"},{default:g((()=>[v(le,{modelValue:O.value.menuIcon,"onUpdate:modelValue":u[2]||(u[2]=e=>O.value.menuIcon=e),placeholder:"请填写菜单ICON图标",style:{width:"240px"}},null,8,["modelValue"])])),_:1})]),y("div",B,[O.value.isSystem?(t(),r(ae,{key:0,label:"加载三方网页地址",prop:"menuIframeUrl"},{default:g((()=>[v(le,{modelValue:O.value.menuIframeUrl,"onUpdate:modelValue":u[3]||(u[3]=e=>O.value.menuIframeUrl=e),placeholder:"请填写加载的三方网页地址",style:{width:"240px"}},null,8,["modelValue"])])),_:1})):(t(),r(ae,{key:1,label:"菜单路径",prop:"menuPath"},{default:g((()=>[v(le,{modelValue:O.value.menuPath,"onUpdate:modelValue":u[4]||(u[4]=e=>O.value.menuPath=e),placeholder:"请填写菜单路径",style:{width:"240px"}},null,8,["modelValue"])])),_:1})),v(ae,{label:"数字编号排序",prop:"order"},{default:g((()=>[v(le,{modelValue:O.value.order,"onUpdate:modelValue":u[5]||(u[5]=e=>O.value.order=e),type:"number",placeholder:"请填写排序Id、越小越靠前",style:{width:"240px"}},null,8,["modelValue"])])),_:1})]),v(ae,{label:"菜单描述",prop:"menuTipText"},{default:g((()=>[v(le,{modelValue:O.value.menuTipText,"onUpdate:modelValue":u[6]||(u[6]=e=>O.value.menuTipText=e),type:"textarea",placeholder:"请填写菜单描述"},null,8,["modelValue"])])),_:1}),v(ae,{label:"菜单封面"},{default:g((()=>[v(te,{class:"avatar-uploader",action:V.value,"show-file-list":!1,"on-success":X,"before-upload":Q},{default:g((()=>[O.value.menuCover?(t(),f("img",{key:0,src:O.value.menuCover,style:{width:"345px",height:"180px","border-radius":"12px"},class:"avatar"},null,8,D)):(t(),r(ee,{key:1,class:"avatar-uploader-icon"},{default:g((()=>[v(ue)])),_:1}))])),_:1},8,["action"])])),_:1}),y("div",M,[v(ae,{label:"是否打开菜单",prop:"isShow"},{default:g((()=>[v(re,{modelValue:O.value.isShow,"onUpdate:modelValue":u[7]||(u[7]=e=>O.value.isShow=e)},null,8,["modelValue"])])),_:1}),v(ae,{label:"是否属于三方网页",prop:"isSystem",style:{"margin-left":"32px"}},{default:g((()=>[v(re,{modelValue:O.value.isSystem,"onUpdate:modelValue":u[8]||(u[8]=e=>O.value.isSystem=e)},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])]),y("div",G,[v(d,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:u[9]||(u[9]=e=>s.value=!1)},{default:g((()=>[h("取消 ")])),_:1}),v(d,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:u[10]||(u[10]=e=>async function(e){null==e||e.validate((async u=>{if(!u)return;if(0==l.isUserModifyPermissions())return x.error("非超级管理员无权限操作！");let t=Object.assign(O.value,{id:I},{menuPlatform:a.value});""==I.value&&delete t.id,await k(t),x.success("操作成功！"),e.resetFields(),s.value=!1,H()}))}(o.value))},{default:g((()=>[h(b(i(R)),1)])),_:1})])])),_:1},8,["modelValue"])])])}}});"function"==typeof V&&V(O);const E=I(O,[["__scopeId","data-v-3a9ad1cb"]]);export{E as default};
