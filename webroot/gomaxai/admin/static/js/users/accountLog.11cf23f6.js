
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{q as e,r as a}from"../index/index.6a62fca0.js";import{u as l}from"../utcformatTime/utcformatTime.f6db2c52.js";import{d as t,u as o,r,E as n,q as i,j as s,V as d,o as u,c as p,b as c,f as g,g as m,Y as f,X as y,e as v,h,w,I as x,t as b,J as _,O as T,_ as z,n as k}from"../main-c47e4581.js";import{o as F}from"../order/order.7aa2b1e0.js";const V={class:"search_card",style:{display:"flex","align-items":"center"}},A={style:{"margin-left":"10px"}},j={style:{"margin-left":"10px"}},C={style:{"margin-left":"10px"}},U={style:{"margin-top":"10px"}},S={key:0},Y={key:1},q={key:2},D=t({__name:"accountLog",setup(t){const z=o();r();const k=r(0),D=r(!1),E=n({page:1,size:15,startTime:"",endTime:"",keyword:"",changeType:"",creaseType:""});r([]);const I=r([]);async function M(){try{D.value=!0;const e=await F.queryAllAccountDetail(E),{rows:a,count:l}=e.data;D.value=!1,k.value=l,I.value=a}catch(e){D.value=!1}}function O(){E.page=1,E.size=15,E.startTime="",E.endTime="",E.keyword="",E.changeType="",E.creaseType="",M()}return i((()=>M())),(t,o)=>{const r=s("el-input"),n=s("el-option"),i=s("el-select"),P=s("el-button"),R=s("RefreshRight"),B=s("el-icon"),J=s("el-table-column"),L=s("el-tag"),X=s("el-popconfirm"),G=s("el-table"),H=s("el-pagination"),K=s("el-row"),N=d("loading");return u(),p("div",null,[c("div",V,[c("div",null,[o[5]||(o[5]=c("div",{style:{color:"#20295A","font-size":"13px","margin-bottom":"10px","font-weight":"400"}}," 搜索关键词 ",-1)),c("div",null,[g(r,{modelValue:E.keyword,"onUpdate:modelValue":o[0]||(o[0]=e=>E.keyword=e),placeholder:"用户名/呢称/手机号/邮箱",style:{width:"200px"}},null,8,["modelValue"])])]),c("div",A,[o[6]||(o[6]=c("div",{style:{color:"#20295A","font-size":"13px","margin-bottom":"10px","font-weight":"400"}}," 明细类型 ",-1)),c("div",null,[g(i,{modelValue:E.changeType,"onUpdate:modelValue":o[1]||(o[1]=e=>E.changeType=e),placeholder:"请选择变更类型",clearable:"",style:{width:"150px"}},{default:m((()=>[(u(!0),p(f,null,y(v(e),(e=>(u(),x(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),c("div",j,[o[7]||(o[7]=c("div",{style:{color:"#20295A","font-size":"13px","margin-bottom":"10px","font-weight":"400"}}," 变更类型 ",-1)),c("div",null,[g(i,{modelValue:E.creaseType,"onUpdate:modelValue":o[2]||(o[2]=e=>E.creaseType=e),placeholder:"请选择变更类型",clearable:"",style:{width:"100px"}},{default:m((()=>[g(n,{label:"收入",value:"increase"}),g(n,{label:"支出",value:"decrease"})])),_:1},8,["modelValue"])])]),c("div",C,[g(P,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",height:"32px",background:"#EFF6FF",color:"#60A5FA","border-radius":"8px","margin-top":"25px"},onClick:M},{default:m((()=>o[8]||(o[8]=[h(" 查询 ")]))),_:1})]),c("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:O},[g(B,{color:"#3B82F6",size:"20"},{default:m((()=>[g(R)])),_:1})])]),c("div",U,[w((u(),x(G,{border:"",height:"70vh",data:I.value,style:{width:"100%"},size:"large"},{default:m((()=>[o[10]||(o[10]=h("--\x3e ")),g(J,{prop:"username",label:"用户名",fixed:""},{default:m((e=>[h(b(null==e.row.username?"--":e.row.username),1)])),_:1}),g(J,{prop:"nickname",label:"用户昵称",fixed:""},{default:m((e=>[h(b(null==e.row.nickname?"--":e.row.nickname),1)])),_:1}),g(J,{prop:"phone",label:"手机号"},{default:m((e=>[h(b(null==e.row.phone?"--":e.row.phone),1)])),_:1}),g(J,{prop:"email",label:"邮箱",width:"280",align:"left"},{default:m((e=>[h(b(""==e.row.email?"--":e.row.email),1)])),_:1}),g(J,{prop:"changeType",label:"明细类型",align:"center"},{default:m((e=>{var l,t,o,r,n;return[null==(null==(l=e.row)?void 0:l.changeType)?(u(),p("div",S," -- ")):_("",!0),(null==(t=e.row)?void 0:t.changeType)>0&&(null==(o=e.row)?void 0:o.changeType)<=7?(u(),p("div",Y,[g(L,{type:"success"},{default:m((()=>{var l;return[h(b(v(a)[null==(l=e.row)?void 0:l.changeType]),1)]})),_:2},1024)])):(null==(r=e.row)?void 0:r.changeType)>=8&&(null==(n=e.row)?void 0:n.changeType)<=40?(u(),p("div",q,[g(L,{type:"danger"},{default:m((()=>{var l;return[h(b(v(a)[null==(l=e.row)?void 0:l.changeType]),1)]})),_:2},1024)])):_("",!0)]})),_:1}),g(J,{prop:"changeScore",label:"积分",align:"left",width:"100"},{default:m((e=>{var a,l;return[h(b(null==(null==(a=e.row)?void 0:a.changeScore)?"--":null==(l=e.row)?void 0:l.changeScore),1)]})),_:1}),g(J,{prop:"updatedAt",label:"结算时间",align:"center"},{default:m((e=>[h(b(v(l)(e.row.updatedAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),g(J,{fixed:"right",label:"操作"},{default:m((e=>[g(X,{title:"确认删除此订单么、删除订单不可恢复?",width:"400","icon-color":"red",onConfirm:a=>async function(e){if(0==z.isUserModifyPermissions())return T.error("非超级管理员无权限操作！");const a=await F.deleteIncomeOrder({ids:[e]});200==a.code?(T({type:"success",message:"删除订单成功"}),M()):T({type:"error",message:a.data})}(e.row.id)},{reference:m((()=>[g(P,{link:"",type:"danger",size:"small"},{default:m((()=>o[9]||(o[9]=[h(" 删除订单 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[N,D.value]]),g(K,{class:"flex justify-end mt-5"},{default:m((()=>[g(H,{"current-page":E.page,"onUpdate:currentPage":o[3]||(o[3]=e=>E.page=e),"page-size":E.size,"onUpdate:pageSize":o[4]||(o[4]=e=>E.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:k.value,onSizeChange:M,onCurrentChange:M},null,8,["current-page","page-size","total"])])),_:1})])])}}});"function"==typeof k&&k(D);const E=z(D,[["__scopeId","data-v-cd3526ab"]]);export{E as default};
