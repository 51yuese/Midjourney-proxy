
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{u as e}from"../utcformatTime/utcformatTime.f6db2c52.js";import{a}from"../config/config.e980ec46.js";import{d as t,u as l,r as n,G as s,x as o,j as i,U as r,o as d,c as u,b as p,f as g,g as c,h as m,w as f,J as h,t as x,e as y,P as w,S as b,p as v,k as _,_ as z,q as I}from"../main-5b9099dc.js";const k=e=>(v("data-v-b109901c"),e=e(),_(),e),F=k((()=>p("div",{style:{color:"#20295","font-size":"15px","font-weight":"bold","margin-bottom":"16px"}},"签到设置",-1))),S=k((()=>p("div",{style:{color:"#9FA3B8","font-size":"15px","margin-right":"12px"}}," 签到奖励 ",-1))),V={style:{"margin-top":"16px"}},j=k((()=>p("div",{style:{color:"#20295","font-size":"15px","font-weight":"bold","margin-bottom":"16px","margin-top":"32px"}},"签到记录",-1))),C={class:"search_add_card"},R={style:{display:"flex","align-items":"center"}},U=k((()=>p("div",{class:"condition_name"},"用户信息",-1))),A={style:{"margin-left":"10px"}},T=["src"],Y=t({__name:"signIn",setup(t){const v=l(),_=n([]),z=n(!1),I=n(0),k=s({signInStatus:0,signInRewards:""}),Y=s({keyword:"",page:1,size:10}),D=n();async function E(){const e=await a.queryConfig({keys:["signInStatus","signInRewards"]});e.data.signInStatus&&(e.data.signInStatus=Number(e.data.signInStatus)),Object.assign(k,e.data)}async function M(){if(0==v.isUserModifyPermissions())return w.error("非超级管理员无权限操作！");if(0!=k.signInStatus)if(k.signInRewards<=0)w.error("开启签到奖励选项后需填写此项");else{try{await a.setConfig({settings:(e=k,Object.keys(e).map((a=>({configKey:a,configVal:e[a]}))))}),w.success("变更配置信息成功")}catch(t){}var e;E()}else w.error("开启签到奖励后当前配置才能生效")}async function P(){try{z.value=!0;const e=await b.getSignlnLog(Y);z.value=!1;const{rows:a,count:t}=e.data;I.value=t,_.value=a}catch(e){z.value=!1}}function q(){Y.keyword="",Y.page=1,Y.size=10,P()}return o((()=>{E(),P()})),(a,t)=>{const l=i("el-switch"),n=i("el-form-item"),s=i("el-input"),o=i("el-form"),w=i("el-button"),b=i("RefreshRight"),v=i("el-icon"),E=i("el-table-column"),B=i("el-table"),O=i("el-pagination"),G=i("el-row"),J=r("loading");return d(),u("div",null,[F,p("div",null,[g(o,{ref_key:"formRef",ref:D,model:k,"label-position":"top"},{default:c((()=>[g(n,null,{default:c((()=>[S,g(l,{modelValue:k.signInStatus,"onUpdate:modelValue":t[0]||(t[0]=e=>k.signInStatus=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1}),g(n,{label:"签到赠送积分",style:{width:"35%"}},{default:c((()=>[g(s,{size:"large",modelValue:k.signInRewards,"onUpdate:modelValue":t[1]||(t[1]=e=>k.signInRewards=e),placeholder:"签到获得的积分数量",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),p("div",V,[g(w,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",background:"#EFF6FF",height:"42px",color:"#60A5FA","border-radius":"8px",padding:"8px 100px"},onClick:M},{default:c((()=>[m("保存设置 ")])),_:1})])]),j,p("div",C,[p("div",R,[p("div",null,[U,g(s,{modelValue:Y.keyword,"onUpdate:modelValue":t[2]||(t[2]=e=>Y.keyword=e),placeholder:"用户名/呢称/手机号/邮箱",style:{width:"200px"}},null,8,["modelValue"])]),p("div",A,[g(w,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",height:"32px",background:"#EFF6FF",color:"#60A5FA","border-radius":"8px","margin-top":"25px"},onClick:P},{default:c((()=>[m(" 查询 ")])),_:1})]),p("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:q},[g(v,{color:"#3B82F6",size:"20"},{default:c((()=>[g(b)])),_:1})])])]),p("div",null,[f((d(),h(B,{border:"","highlight-current-row":"",data:_.value,style:{width:"100%"},"max-height":"43vh"},{default:c((()=>[g(E,{type:"index",label:"排序ID",width:"80"}),g(E,{prop:"displaySort",label:"用户头像"},{default:c((e=>[p("img",{src:e.row.avatar,style:{width:"42px",height:"42px","border-radius":"8px"}},null,8,T)])),_:1}),g(E,{prop:"username",label:"用户名"},{default:c((e=>[m(x(null==e.row.username?"--":e.row.username),1)])),_:1}),g(E,{prop:"nickname",label:"用户昵称"},{default:c((e=>[m(x(null==e.row.nickname?"--":e.row.nickname),1)])),_:1}),g(E,{prop:"phone",label:"手机号"},{default:c((e=>[m(x(null==e.row.phone?"--":e.row.phone),1)])),_:1}),g(E,{prop:"email",label:"邮箱",width:"220px"},{default:c((e=>[m(x(null==e.row.email?"--":e.row.email),1)])),_:1}),g(E,{prop:"signInTime",label:"签到时间",width:"220px"},{default:c((a=>[m(x(y(e)(a.row.signInTime,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),g(E,{prop:"score",label:"奖励积分",width:"120"})])),_:1},8,["data"])),[[J,z.value]])]),g(G,{class:"flex justify-end mt-3"},{default:c((()=>[g(O,{"current-page":Y.page,"onUpdate:currentPage":t[3]||(t[3]=e=>Y.page=e),"page-size":Y.size,"onUpdate:pageSize":t[4]||(t[4]=e=>Y.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:I.value,onSizeChange:P,onCurrentChange:P},null,8,["current-page","page-size","total"])])),_:1})])}}});"function"==typeof I&&I(Y);const D=z(Y,[["__scopeId","data-v-b109901c"]]);export{D as default};
