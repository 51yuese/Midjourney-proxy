
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{z as e,d as s,i as a,l as o,u as l,a as t,A as d,B as r,C as i,D as n,x as u,E as p,F as m,r as g,G as c,j as w,o as b,c as f,b as v,f as x,H as y,e as h,I as P,J as j,K as k,g as _,T as M,w as C,v as F,L as V,M as S,N as z,h as D,O as N,P as A,y as I,p as L,k as B,_ as H}from"../main-5b9099dc.js";import{_ as T}from"../index/index.4f679b8c.js";import U from"../views/link.9a80a8d3.js";import q from"../Header/index.5dcba8f4.js";import E from"../MainSidebar/index.315896b5.js";import R from"../SubSidebar/index.e43524a9.js";import $ from"../Topbar/index.a3518e36.js";import G from"../Search/index.7cc88c62.js";import J from"../HotkeysIntro/index.fbe94dec.js";import K from"../AppSetting/index.4c624ef2.js";import{u as O}from"../useMenu/useMenu.874b916e.js";import"../config/config.e980ec46.js";import"../index/index.7b018e8d.js";import"../Logo/index.47348bce.js";import"../Tools/index.5d536f63.js";import"../index/index.d40e4446.js";import"../SidebarItem/index.ad56f5af.js";const W={class:"layout"},X={id:"app-main"},Y={class:"wrapper"},Z={class:"main"},Q={key:0},ee={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},se=(e=>(L("data-v-228599c5"),e=e(),B(),e))((()=>v("div",null," 修改密码 ",-1))),ae={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},oe={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},le=s({name:"Layout"}),te=H(s({...le,setup(s){const L=a(),B=o(),H=l(),le=t(),te=d(),de=r(),re=i((()=>H.getModifyPasswordDialog())),ie=i((()=>!!L.meta.link));n((()=>le.settings.menu.subMenuCollapse),(e=>{"mobile"===le.mode&&(e?document.body.classList.remove("overflow-hidden"):document.body.classList.add("overflow-hidden"))})),n((()=>L.path),(()=>{"mobile"===le.mode&&le.$patch((e=>{e.settings.menu.subMenuCollapse=!0}))})),u((()=>{p("f5",(s=>{le.settings.toolbar.enablePageReload&&(s.preventDefault(),e.push({name:"reload"}))})),p("alt+`",(e=>{le.settings.menu.enableHotkeys&&(e.preventDefault(),O().switchTo(de.actived+1<de.allMenus.length?de.actived+1:0))}))})),m((()=>{p.unbind("f5"),p.unbind("alt+`")}));const ne=g(),ue=g({oldPassword:"",newPassword:"",repeatNewPassword:""}),pe=c({oldPassword:[{required:!0,message:"原密码不能为空",trigger:"blur"},{min:6,message:"长度不能少于6位",trigger:"blur"}],newPassword:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"长度不能少于6位",trigger:"blur"}],repeatNewPassword:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"长度不能少于6位",trigger:"blur"}]});function me(){ne.value.validate((async e=>{var s,a,o,l;if(!e)return;if((null==(s=ue.value)?void 0:s.newPassword)!=(null==(a=ue.value)?void 0:a.repeatNewPassword))return void A.error("两次输入的密码不一致");const t=await H.editPassword({password:null==(o=ue.value)?void 0:o.newPassword,oldPassword:null==(l=ue.value)?void 0:l.oldPassword});200==t.code?(A.success(t.data),H.updateModifyPasswordDialog(!1),H.logout().then((()=>{B.push({name:"login"})}))):A.error(t.data)}))}return(e,s)=>{const a=w("router-view"),o=T,l=w("el-backtop"),t=I,d=w("el-icon"),r=w("el-input"),i=w("el-form-item"),n=w("el-form"),u=w("el-button"),p=w("el-dialog");return b(),f("div",W,[v("div",X,[x(q),v("div",Y,[v("div",{class:y(["sidebar-container",{show:"mobile"===h(le).mode&&!h(le).settings.menu.subMenuCollapse}])},[x(E),x(R)],2),v("div",{class:y(["sidebar-mask",{show:"mobile"===h(le).mode&&!h(le).settings.menu.subMenuCollapse}]),onClick:s[0]||(s[0]=e=>h(le).toggleSidebarCollapse())},null,2),v("div",{class:"main-container",style:P({"padding-bottom":e.$route.meta.paddingBottom})},["head"!==h(le).settings.menu.menuMode||h(le).settings.menu.enableSubMenuCollapseButton||h(le).settings.breadcrumb.enable?(b(),j($,{key:0})):k("",!0),v("div",Z,[x(a,null,{default:_((({Component:e,route:s})=>[x(M,{name:"main",mode:"out-in",appear:""},{default:_((()=>[(b(),j(S,{include:h(te).list},[C((b(),j(V(e),{key:s.fullPath})),[[F,!h(ie)]])],1032,["include"]))])),_:2},1024)])),_:1}),h(ie)?(b(),j(U,{key:0})):k("",!0)]),x(o)],4)]),x(l,{right:20,bottom:20,title:"回到顶部"})]),x(G),x(J),h(le).settings.app.enableAppSetting?(b(),f("div",Q,[x(d,{class:"app-setting",onClick:s[1]||(s[1]=e=>h(z).emit("global-app-setting-toggle"))},{default:_((()=>[x(t,{name:"ep:setting"})])),_:1}),x(K)])):k("",!0),x(p,{modelValue:h(re),"onUpdate:modelValue":s[7]||(s[7]=e=>N(re)?re.value=e:null),width:"400","show-close":!1,"destroy-on-close":""},{header:_((({close:e,titleId:a,titleClass:o})=>[v("div",ee,[se,v("div",{onClick:s[2]||(s[2]=e=>h(H).updateModifyPasswordDialog(!1)),style:{cursor:"pointer"}},[x(d,null,{default:_((()=>[x(t,{name:"close"})])),_:1})])])])),default:_((()=>[v("div",ae,[x(n,{ref_key:"modifyPasswordFormRef",ref:ne,rules:h(pe),model:h(ue),"label-width":"auto",style:{"max-width":"400px"}},{default:_((()=>[x(i,{label:"原密码",prop:"oldPassword",size:"large"},{default:_((()=>[x(r,{size:"large",placeholder:"请输入原密码",modelValue:h(ue).oldPassword,"onUpdate:modelValue":s[3]||(s[3]=e=>h(ue).oldPassword=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1}),x(i,{label:"新密码",prop:"newPassword",size:"large"},{default:_((()=>[x(r,{size:"large",placeholder:"请输入新密码",modelValue:h(ue).newPassword,"onUpdate:modelValue":s[4]||(s[4]=e=>h(ue).newPassword=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1}),x(i,{label:"重复新密码",prop:"repeatNewPassword",size:"large"},{default:_((()=>[x(r,{size:"large",placeholder:"请重复输入新密码",modelValue:h(ue).repeatNewPassword,"onUpdate:modelValue":s[5]||(s[5]=e=>h(ue).repeatNewPassword=e),type:"password","show-password":""},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])]),v("div",oe,[x(u,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:s[6]||(s[6]=e=>h(H).updateModifyPasswordDialog(!1))},{default:_((()=>[D("取消 ")])),_:1}),x(u,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:me},{default:_((()=>[D(" 确定 ")])),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-228599c5"]]);export{te as default};
