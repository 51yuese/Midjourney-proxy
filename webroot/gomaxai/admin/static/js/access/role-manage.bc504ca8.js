
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,r as l,F as a,E as o,q as t,j as r,V as d,o as i,c as n,b as s,f as u,e as p,g as c,h as m,W as g,w as f,I as b,t as v,J as y,N as _,O as x,s as w,_ as h}from"../main-c47e4581.js";import{_ as k}from"../permission.vue_vue_type_script_setup_true_lang/permission.vue_vue_type_script_setup_true_lang.67f76dc4.js";import{a as F}from"./access.ae69f1ea.js";const V={class:"search_add_card"},C={style:{display:"flex","align-items":"center"}},z={style:{"margin-left":"10px"}},j={style:{"margin-top":"12px"}},U={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},A={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)","overflow-y":"scroll","overflow-x":"hidden"}},R={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},B=h(e({__name:"role-manage",setup(e){const h=l(),B=l(),E=a(!1),q=a(!1),I=a(0),P=a("添加角色"),S=l([]),D=l({}),J=o({page:1,size:10,keyword:""}),N={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],code:[{required:!0,message:"请输入角色代码",trigger:"blur"}]},O=a(!1);function W(){J.page=1,J.keyword="",H()}function G(){D.value={},q.value=!0,P.value="添加角色"}async function H(){const{data:e}=await F.getRolePage(J);S.value=e.rows,O.value&&e.rows.length>1&&(K(e.rows[0]),O.value=!1)}function K(e){B.value.open(e)}return t((()=>{H()})),(e,l)=>{const a=r("el-input"),o=r("el-button"),t=r("el-icon"),L=r("el-table-column"),M=r("el-tag"),Q=r("el-link"),T=r("el-popconfirm"),X=r("el-space"),Y=r("el-table"),Z=r("el-pagination"),$=r("el-row"),ee=w,le=r("el-form-item"),ae=r("el-switch"),oe=r("el-form"),te=r("el-dialog"),re=d("loading");return i(),n("div",null,[s("div",V,[s("div",C,[s("div",null,[l[11]||(l[11]=s("div",{class:"condition_name"}," 角色搜索 ",-1)),u(a,{modelValue:p(J).keyword,"onUpdate:modelValue":l[0]||(l[0]=e=>p(J).keyword=e),placeholder:"角色名称或角色编码",clearable:""},null,8,["modelValue"])]),s("div",z,[u(o,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",height:"32px",background:"#EFF6FF",color:"#60A5FA","border-radius":"8px","margin-top":"25px"},onClick:H},{default:c((()=>l[12]||(l[12]=[m(" 查询 ")]))),_:1})]),s("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:W},[u(t,{color:"#3B82F6",size:"20"},{default:c((()=>[u(p(g))])),_:1})])]),s("div",null,[u(o,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px","margin-top":"25px"},onClick:G},{default:c((()=>l[13]||(l[13]=[m(" 添加代理商 ")]))),_:1})])]),s("div",j,[f((i(),b(Y,{border:"",data:p(S),height:"66vh",width:"100%"},{default:c((()=>[u(L,{prop:"id",label:"角色ID"}),u(L,{prop:"name",label:"角色名"}),u(L,{prop:"code",label:"角色代码"}),u(L,{prop:"disabled",label:"禁用"},{default:c((({row:e})=>[u(M,{type:1===e.disabled?"danger":"success"},{default:c((()=>[m(v(1===e.disabled?"禁用":"正常"),1)])),_:2},1032,["type"])])),_:1}),u(L,{prop:"createdAt",label:"创建时间"}),u(L,{label:"操作"},{default:c((({row:e})=>[u(X,null,{default:c((()=>[u(Q,{type:"primary",underline:!1,onClick:l=>function(e){D.value=e,q.value=!0,P.value="编辑角色"}(e)},{default:c((()=>l[14]||(l[14]=[m(" 编辑 ")]))),_:2},1032,["onClick"]),1!==e.id&&3!==e.id?(i(),b(Q,{key:0,type:"primary",underline:!1,onClick:l=>K(e)},{default:c((()=>l[15]||(l[15]=[m(" 权限管理 ")]))),_:2},1032,["onClick"])):y("",!0),u(T,{title:"确认删除该角色？",onConfirm:l=>async function(e){await F.deleteRole({ids:[e]}),await H()}(e.id)},{reference:c((()=>[u(Q,{type:"danger",underline:!1},{default:c((()=>l[16]||(l[16]=[m(" 删除 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[re,p(E)]]),u($,{class:"flex justify-end mt-5 pb-5"},{default:c((()=>[u(Z,{"current-page":p(J).page,"onUpdate:currentPage":l[1]||(l[1]=e=>p(J).page=e),"page-size":p(J).size,"onUpdate:pageSize":l[2]||(l[2]=e=>p(J).size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:p(I),onSizeChange:H,onCurrentChange:H},null,8,["current-page","page-size","total"])])),_:1})]),u(te,{modelValue:p(q),"onUpdate:modelValue":l[10]||(l[10]=e=>_(q)?q.value=e:null),"show-close":!1,width:"500px"},{header:c((()=>[s("div",U,[s("div",null,v(p(P)),1),s("div",{style:{cursor:"pointer"},onClick:l[3]||(l[3]=e=>q.value=!1)},[u(t,null,{default:c((()=>[u(ee,{name:"close"})])),_:1})])])])),default:c((()=>[s("div",A,[u(oe,{ref_key:"formRef",ref:h,model:p(D),"label-width":"120px",rules:N},{default:c((()=>[u(le,{label:"角色名称"},{default:c((()=>[u(a,{modelValue:p(D).name,"onUpdate:modelValue":l[4]||(l[4]=e=>p(D).name=e),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),u(le,{label:"角色代码"},{default:c((()=>[u(a,{modelValue:p(D).code,"onUpdate:modelValue":l[5]||(l[5]=e=>p(D).code=e),placeholder:"请输入角色代码"},null,8,["modelValue"])])),_:1}),u(le,{label:"是否可用"},{default:c((()=>[u(ae,{modelValue:p(D).disabled,"onUpdate:modelValue":l[6]||(l[6]=e=>p(D).disabled=e),"active-value":0,"inactive-value":1},null,8,["modelValue"])])),_:1}),u(le,{label:"备注"},{default:c((()=>[u(a,{modelValue:p(D).remark,"onUpdate:modelValue":l[7]||(l[7]=e=>p(D).remark=e),type:"textarea",placeholder:"备注"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])]),s("div",R,[u(o,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[8]||(l[8]=e=>q.value=!1)},{default:c((()=>l[17]||(l[17]=[m(" 取消 ")]))),_:1}),u(o,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:l[9]||(l[9]=e=>async function(e){e&&await e.validate((async e=>{e&&(await F.saveRole(D.value),O.value=!0,x.success("提交成功！"),q.value=!1,await H())}))}(p(h)))},{default:c((()=>l[18]||(l[18]=[m(" 确定 ")]))),_:1})])])),_:1},8,["modelValue"]),u(k,{ref_key:"permissionRef",ref:B},null,512)])}}}),[["__scopeId","data-v-04ea05d0"]]);export{B as default};
