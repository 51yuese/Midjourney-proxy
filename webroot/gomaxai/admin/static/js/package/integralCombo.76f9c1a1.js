
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{d as e,u as l,r as a,A as r,E as o,q as t,j as s,V as i,o as d,c as u,b as n,f as p,g as c,h as m,w as g,I as f,t as b,e as v,P as y,O as _,s as h,_ as x}from"../main-31e47da4.js";import{A as w}from"./package.2b923685.js";import{u as V}from"../utcformatTime/utcformatTime.f6db2c52.js";const F={class:"search_add_card"},z={style:{display:"flex","align-items":"center"}},k={style:{"margin-left":"10px"}},P={style:{color:"#20295A","font-size":"15px","font-weight":"bold","background-color":"#EFF6FF",padding:"15px 20px","border-top":"15px",display:"flex","align-items":"center","justify-content":"space-between","border-top-right-radius":"15px","border-top-left-radius":"15px"}},C={style:{padding:"0 20px","border-bottom":"1px solid var(--el-border-color-lighter)"}},U={class:"form_item_div"},q={class:"form_item_div"},j={class:"form_item_div"},A={style:{padding:"20px",display:"flex","align-items":"center","justify-content":"space-between"}},M=x(e({__name:"integralCombo",setup(e){const x=l(),M=a(0),B=a([]),E=a(!1),I=a(!1),Y=a(),D=a(0),R=r((()=>D.value?"更新套餐":"新增套餐")),O=r((()=>D.value?"确认更新":"确认新增")),S=o({page:1,seze:15,type:1,status:""}),T=o({id:0,name:"",type:1,order:10,originPrice:0,price:0,days:0,score:1,des:"",scope:"",status:0}),$=o({name:[{required:!0,message:"请输入套餐名称",trigger:"blur"}],order:[{required:!0,message:"请输入套餐排序",trigger:"blur"}],originPrice:[{required:!0,message:"请输入套餐原价",trigger:"blur"}],price:[{required:!0,message:"请输入套餐折扣价",trigger:"blur"}],score:[{required:!0,message:"请输入赠送积分的额度",trigger:"blur"}],des:[{required:!0,message:"请输入套餐描述",trigger:"blur"}],scope:[{required:!0,message:"请输入权益描述",trigger:"blur"}],status:[{required:!0,message:"",trigger:"blur"}]});async function G(){try{E.value=!0;const e=await w.queryAllPackage(S);E.value=!1;const{rows:l,count:a}=e.data;M.value=a,B.value=l}catch(e){E.value=!1}}function H(){S.type=1,S.page=1,S.seze=15,S.status="",G()}function J(){D.value=0,T.id=0,T.name="",T.type=1,T.order=10,T.originPrice=0,T.price=0,T.days=0,T.score=1,T.des="",T.scope="",T.status=0,I.value=!0}function K(){Y.value.validate((async e=>{if(e){if(0==x.isUserModifyPermissions())return _.error("非超级管理员无权限操作！");if(0==D.value){delete T.id;if(200!=(await w.createPackage(T)).code)return void _({type:"warning",message:res.data});_({type:"success",message:"套餐新增成功！"}),I.value=!1,G()}else{T.id=D.value;const e=await w.updatePackage(T);if(200!=e.code)return void _({type:"warning",message:e.data});_({type:"success",message:"套餐修改成功！"}),I.value=!1,G()}}}))}return t((()=>{G()})),(e,l)=>{const a=s("el-alert"),r=s("el-option"),o=s("el-select"),t=s("el-button"),L=s("RefreshRight"),N=s("el-icon"),Q=s("el-table-column"),W=s("el-tag"),X=s("el-popconfirm"),Z=s("el-table"),ee=s("el-pagination"),le=s("el-row"),ae=h,re=s("el-input"),oe=s("el-form-item"),te=s("el-switch"),se=s("el-form"),ie=s("el-dialog"),de=i("loading");return d(),u("div",null,[n("div",null,[n("div",null,[p(a,{closable:!1,"show-icon":"",title:"说明",description:"积分套餐是不限制使用时间，用完为止，可叠加充值",type:"warning"})]),n("div",F,[n("div",z,[n("div",null,[l[14]||(l[14]=n("div",{class:"condition_name"},"套餐状态",-1)),p(o,{clearable:"",modelValue:S.status,"onUpdate:modelValue":l[0]||(l[0]=e=>S.status=e),placeholder:"请选择套餐状态",style:{width:"150px"}},{default:c((()=>[p(r,{label:"启用",value:1}),p(r,{label:"禁用",value:0})])),_:1},8,["modelValue"])]),n("div",k,[p(t,{bg:"",text:"",type:"primary",size:"large",style:{"font-size":"15px",height:"32px",background:"#EFF6FF",color:"#60A5FA","border-radius":"8px","margin-top":"25px"},onClick:G},{default:c((()=>l[15]||(l[15]=[m(" 查询 ")]))),_:1})]),n("div",{style:{"margin-left":"12px","background-color":"#EFF6FF",padding:"4px 16px","border-radius":"8px","margin-top":"22px",cursor:"pointer"},onClick:H},[p(N,{color:"#3B82F6",size:"20"},{default:c((()=>[p(L)])),_:1})])]),n("div",null,[p(t,{style:{"border-radius":"8px",border:"1px solid #3B82F6",color:"#3B82F6","font-size":"15px",height:"32px","margin-top":"25px"},onClick:J},{default:c((()=>l[16]||(l[16]=[m(" 新增积分套餐 ")]))),_:1})])]),n("div",null,[g((d(),f(Z,{border:"","highlight-current-row":"",data:B.value,style:{width:"100%"},"max-height":"70vh"},{default:c((()=>[p(Q,{prop:"order",label:"排序ID"}),p(Q,{prop:"name",label:"套餐名称"}),p(Q,{prop:"originPrice",label:"套餐原价"}),p(Q,{prop:"price",label:"套餐折扣价"}),p(Q,{prop:"score",label:"积分额度"}),p(Q,{prop:"status",label:"套餐状态"},{default:c((e=>[n("div",null,[1==e.row.status?(d(),f(W,{key:0,type:"primary"},{default:c((()=>l[17]||(l[17]=[m("启用")]))),_:1})):(d(),f(W,{key:1,type:"danger"},{default:c((()=>l[18]||(l[18]=[m("禁用")]))),_:1}))])])),_:1}),p(Q,{prop:"createdAt",label:"创建时间",width:"190"},{default:c((e=>[n("div",null,b(v(V)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)])),_:1}),p(Q,{fixed:"right",label:"操作",width:"160"},{default:c((e=>[p(t,{style:{border:"none",color:"#3B82F6","font-size":"13px","background-color":"transparent"},onClick:l=>function(e){D.value=e.id;const{id:l,name:a,type:r,order:o,originPrice:t,price:s,score:i,des:d,scope:u,status:n}=e;y((()=>{Object.assign(T,{id:l,name:a,type:r,order:o,originPrice:t,price:s,score:i,des:d,scope:u,status:n})})),I.value=!0}(e.row)},{default:c((()=>l[19]||(l[19]=[m("编辑 ")]))),_:2},1032,["onClick"]),p(X,{title:"确认删除此套餐么?",width:"180","icon-color":"red",onConfirm:l=>async function(e){if(0==x.isUserModifyPermissions())return _.error("非超级管理员无权限操作！");const l=await w.delPackage({ids:[e.id]});200==l.code?(_({type:"success",message:"套餐删除成功！"}),G()):_({type:"warning",message:l.data})}(e.row)},{reference:c((()=>[p(t,{style:{border:"none",color:"#FF3B30","font-size":"13px","background-color":"transparent"}},{default:c((()=>l[20]||(l[20]=[m("删除 ")]))),_:1})])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"])),[[de,E.value]])]),p(le,{class:"flex justify-end mt-3"},{default:c((()=>[p(ee,{"current-page":S.page,"onUpdate:currentPage":l[1]||(l[1]=e=>S.page=e),"page-size":S.size,"onUpdate:pageSize":l[2]||(l[2]=e=>S.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:M.value,onSizeChange:G,onCurrentChange:G},null,8,["current-page","page-size","total"])])),_:1})]),p(ie,{modelValue:I.value,"onUpdate:modelValue":l[13]||(l[13]=e=>I.value=e),width:"750","show-close":!1,"destroy-on-close":""},{header:c((({close:e,titleId:a,titleClass:r})=>[n("div",P,[n("div",null,b(R.value),1),n("div",{onClick:l[3]||(l[3]=e=>I.value=!1),style:{cursor:"pointer"}},[p(N,null,{default:c((()=>[p(ae,{name:"close"})])),_:1})])])])),default:c((()=>[n("div",C,[p(se,{"label-width":"110px",model:T,rules:$,ref_key:"formRef",ref:Y},{default:c((()=>[n("div",U,[p(oe,{label:"套餐名称",prop:"name"},{default:c((()=>[p(re,{modelValue:T.name,"onUpdate:modelValue":l[4]||(l[4]=e=>T.name=e),class:"form_input",size:"large",placeholder:"请输入套餐名称"},null,8,["modelValue"])])),_:1}),p(oe,{label:"套餐排序",prop:"order"},{default:c((()=>[p(re,{modelValue:T.order,"onUpdate:modelValue":l[5]||(l[5]=e=>T.order=e),modelModifiers:{number:!0},class:"form_input",size:"large",placeholder:"请输入套餐排序"},null,8,["modelValue"])])),_:1})]),n("div",q,[p(oe,{label:"套餐原价",prop:"originPrice"},{default:c((()=>[p(re,{modelValue:T.originPrice,"onUpdate:modelValue":l[6]||(l[6]=e=>T.originPrice=e),modelModifiers:{number:!0},class:"form_input",size:"large",placeholder:"请输入套餐原价"},null,8,["modelValue"])])),_:1}),p(oe,{label:"套餐折扣价",prop:"price"},{default:c((()=>[p(re,{modelValue:T.price,"onUpdate:modelValue":l[7]||(l[7]=e=>T.price=e),modelModifiers:{number:!0},class:"form_input",size:"large",placeholder:"请输入套餐折扣价"},null,8,["modelValue"])])),_:1})]),n("div",j,[p(oe,{label:"赠送积分额度",prop:"score"},{default:c((()=>[p(re,{modelValue:T.score,"onUpdate:modelValue":l[8]||(l[8]=e=>T.score=e),modelModifiers:{number:!0},class:"form_input",size:"large",placeholder:"请输入所赠送积分额度"},null,8,["modelValue"])])),_:1})]),p(oe,{label:"套餐描述",prop:"des"},{default:c((()=>[p(re,{modelValue:T.des,"onUpdate:modelValue":l[9]||(l[9]=e=>T.des=e),size:"large",placeholder:"请输入套餐描述"},null,8,["modelValue"])])),_:1}),p(oe,{label:"权益描述",prop:"scope"},{default:c((()=>[p(re,{modelValue:T.scope,"onUpdate:modelValue":l[10]||(l[10]=e=>T.scope=e),size:"large",placeholder:"请输入权益描述"},null,8,["modelValue"])])),_:1}),p(oe,{label:"套餐状态",prop:"status"},{default:c((()=>[p(te,{modelValue:T.status,"onUpdate:modelValue":l[11]||(l[11]=e=>T.status=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])]),n("div",A,[p(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#F4F4F5",color:"#20295A","border-radius":"8px"},onClick:l[12]||(l[12]=e=>I.value=!1)},{default:c((()=>l[21]||(l[21]=[m("取消 ")]))),_:1}),p(t,{bg:"",text:"",style:{width:"40%",padding:"20px 0","background-color":"#3B82F6",color:"#FFF","border-radius":"8px"},type:"primary",onClick:K},{default:c((()=>[m(b(O.value),1)])),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-4acf7660"]]);export{M as default};
