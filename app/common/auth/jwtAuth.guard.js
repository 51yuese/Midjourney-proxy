'use strict';const _0xe033cc=_0x2ca7;(function(_0x43a573,_0x48045e){const _0x4b874c=_0x2ca7,_0x578f34=_0x43a573();while(!![]){try{const _0x27c28f=parseInt(_0x4b874c(0x93))/0x1+parseInt(_0x4b874c(0xaf))/0x2+-parseInt(_0x4b874c(0x99))/0x3*(parseInt(_0x4b874c(0xbf))/0x4)+-parseInt(_0x4b874c(0x8c))/0x5+-parseInt(_0x4b874c(0xa4))/0x6*(parseInt(_0x4b874c(0xbd))/0x7)+parseInt(_0x4b874c(0xa1))/0x8+-parseInt(_0x4b874c(0xc3))/0x9*(-parseInt(_0x4b874c(0xc0))/0xa);if(_0x27c28f===_0x48045e)break;else _0x578f34['push'](_0x578f34['shift']());}catch(_0x29fce1){_0x578f34['push'](_0x578f34['shift']());}}}(_0x41f9,0x371dc));function _0x2ca7(_0x1b4fdd,_0x5f086c){const _0x41f962=_0x41f9();return _0x2ca7=function(_0x2ca7c9,_0x5458bc){_0x2ca7c9=_0x2ca7c9-0x8c;let _0x2b38bc=_0x41f962[_0x2ca7c9];return _0x2b38bc;},_0x2ca7(_0x1b4fdd,_0x5f086c);}var __decorate=this&&this[_0xe033cc(0xc4)]||function(_0x17a2d5,_0x45e6c8,_0x4becad,_0x51f1ad){const _0x2279ee=_0xe033cc;var _0x31e23a=arguments[_0x2279ee(0xb1)],_0x2c4a91=_0x31e23a<0x3?_0x45e6c8:_0x51f1ad===null?_0x51f1ad=Object['getOwnPropertyDescriptor'](_0x45e6c8,_0x4becad):_0x51f1ad,_0x4b67f9;if(typeof Reflect===_0x2279ee(0xc5)&&typeof Reflect['decorate']===_0x2279ee(0x9a))_0x2c4a91=Reflect['decorate'](_0x17a2d5,_0x45e6c8,_0x4becad,_0x51f1ad);else{for(var _0x52d765=_0x17a2d5[_0x2279ee(0xb1)]-0x1;_0x52d765>=0x0;_0x52d765--)if(_0x4b67f9=_0x17a2d5[_0x52d765])_0x2c4a91=(_0x31e23a<0x3?_0x4b67f9(_0x2c4a91):_0x31e23a>0x3?_0x4b67f9(_0x45e6c8,_0x4becad,_0x2c4a91):_0x4b67f9(_0x45e6c8,_0x4becad))||_0x2c4a91;}return _0x31e23a>0x3&&_0x2c4a91&&Object['defineProperty'](_0x45e6c8,_0x4becad,_0x2c4a91),_0x2c4a91;},__metadata=this&&this[_0xe033cc(0x95)]||function(_0x9b8df7,_0x429860){const _0x412843=_0xe033cc;if(typeof Reflect===_0x412843(0xc5)&&typeof Reflect[_0x412843(0xb4)]===_0x412843(0x9a))return Reflect[_0x412843(0xb4)](_0x9b8df7,_0x429860);};function _0x41f9(){const _0x2315bf=['2023728jBGMxe','checkTokenAuth','env','963942YVxSID','defineProperty','split','AuthGuard','saasId','design:paramtypes','clsService','moduleRef','fingerprint','JwtAuthGuard','authorization','249118ExFMeh','JWT_SECRET','length','../../modules/redisCache/redisCache.service','err:\x20','metadata','extractToken','AuthService','__esModule','handleRequest','role','createTokenFromFingerprint','HttpStatus','RedisCacheService','14MrsOFX','log','688036JidjfB','5403910gnIHOb','亲爱的用户,请登录后继续操作,我们正在等您的到来！','getRequest','9sIjkkq','__decorate','object','nestjs-cls','478495NzlBIJ','get','Injectable','@nestjs/core','getReqSaasId','ClsService','slice','68871psPCll','Bearer','__metadata','HttpException','UNAUTHORIZED','headers','6ZzDgtf','function','redisCacheService','authService','id:\x20','user','validateToken','../../modules/auth/auth.service'];_0x41f9=function(){return _0x2315bf;};return _0x41f9();}Object[_0xe033cc(0xa5)](exports,_0xe033cc(0xb7),{'value':!![]}),exports[_0xe033cc(0xad)]=void 0x0;const redisCache_service_1=require(_0xe033cc(0xb2)),common_1=require('@nestjs/common'),passport_1=require('@nestjs/passport'),jwt=require('jsonwebtoken'),core_1=require(_0xe033cc(0x8f)),auth_service_1=require(_0xe033cc(0xa0)),nestjs_cls_1=require(_0xe033cc(0xc6)),utils_1=require('../utils');let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0xe033cc(0xa7)])('jwt'){constructor(_0x272dc4,_0x5c2e7d,_0x22cb20,_0x4b156c){const _0x5f5b82=_0xe033cc;super(),this[_0x5f5b82(0x9b)]=_0x272dc4,this[_0x5f5b82(0xab)]=_0x5c2e7d,this['clsService']=_0x22cb20,this[_0x5f5b82(0x9c)]=_0x4b156c;}async['canActivate'](_0x4d615a){const _0x3effc7=_0xe033cc;!this[_0x3effc7(0x9b)]&&(this[_0x3effc7(0x9b)]=this[_0x3effc7(0xab)][_0x3effc7(0x8d)](redisCache_service_1[_0x3effc7(0xbc)],{'strict':![]}));const _0x5a7b16=_0x4d615a['switchToHttp']()[_0x3effc7(0xc2)](),_0x4249ef=this[_0x3effc7(0xb5)](_0x5a7b16);_0x5a7b16[_0x3effc7(0x9e)]=this[_0x3effc7(0x9f)](_0x4249ef);if(_0x5a7b16[_0x3effc7(0x9e)][_0x3effc7(0xb9)]==='visitor')throw new common_1['HttpException'](_0x3effc7(0xc1),common_1['HttpStatus']['UNAUTHORIZED']);return await this[_0x3effc7(0x9b)][_0x3effc7(0xa2)](_0x4249ef,_0x5a7b16),!![];}['extractToken'](_0x306ddd){const _0x435e9a=_0xe033cc;if(!_0x306ddd[_0x435e9a(0x98)]['authorization']){if(_0x306ddd[_0x435e9a(0x98)][_0x435e9a(0xac)]){let _0x20c3c0=_0x306ddd[_0x435e9a(0x98)][_0x435e9a(0xac)];return _0x20c3c0>0x7fffffff&&(_0x20c3c0=_0x20c3c0['toString']()[_0x435e9a(0x92)](-0x9),_0x20c3c0=Number(String(Number(_0x20c3c0))),console['log'](_0x435e9a(0x9d),_0x20c3c0)),this[_0x435e9a(0x9c)][_0x435e9a(0xba)](_0x20c3c0);}return null;}const _0x384956=_0x306ddd[_0x435e9a(0x98)][_0x435e9a(0xae)][_0x435e9a(0xa6)]('\x20');if(_0x384956[_0x435e9a(0xb1)]!==0x2||_0x384956[0x0]!==_0x435e9a(0x94))return null;return _0x384956[0x1];}[_0xe033cc(0x9f)](_0x2a9340){const _0x522582=_0xe033cc;try{const _0x1c2f52=(0x0,utils_1[_0x522582(0x90)])(this[_0x522582(0xaa)]),_0x511e3e=jwt['verify'](_0x2a9340,process[_0x522582(0xa3)][_0x522582(0xb0)]);if(_0x511e3e?.[_0x522582(0xa8)]!==_0x1c2f52)throw new common_1['HttpException'](_0x522582(0xc1),common_1['HttpStatus'][_0x522582(0x97)]);return _0x511e3e;}catch(_0x451143){throw new common_1[(_0x522582(0x96))](_0x522582(0xc1),common_1[_0x522582(0xbb)][_0x522582(0x97)]);}}[_0xe033cc(0xb8)](_0x36bb19,_0x28d9d9,_0x40bac5){const _0x3acafd=_0xe033cc;if(_0x36bb19||!_0x28d9d9){console[_0x3acafd(0xbe)](_0x3acafd(0xb3),_0x36bb19);throw _0x36bb19||new common_1['UnauthorizedException']();}return _0x28d9d9;}};JwtAuthGuard=__decorate([(0x0,common_1[_0xe033cc(0x8e)])(),__metadata(_0xe033cc(0xa9),[redisCache_service_1[_0xe033cc(0xbc)],core_1['ModuleRef'],nestjs_cls_1[_0xe033cc(0x91)],auth_service_1[_0xe033cc(0xb6)]])],JwtAuthGuard),exports[_0xe033cc(0xad)]=JwtAuthGuard;