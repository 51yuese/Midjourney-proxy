'use strict';function _0x4ffc(){const _0x318d9b=['catch','730AbLKgj','upload\x20image\x20fail,\x20no\x20attachment','setAttachment','POST','18474RkCUep','getCommand','提交图片:\x20','guild_id','channel_id','2777957pfDubJ','60vYBeqT','attachments','stringify','707985HmWUoh','filter','1104gvNjYg','log','134013AjpaHa','./utils','then','interactions','upload_url','please\x20invoke\x20`init`\x20method\x20before\x20every\x20operate','info','MidjourneyCommand','json','session_id','application/json','MidjourneyApi','describe','blend','inpaint','post','createRandomId','149467xTpiww','imagine','936929561302675456','map','164wHGidL','all','upload\x20image\x20fail,\x20because\x20of\x20upload\x20fail','/attachments','waitMessage','8olxvQi','getPayload','relax','status','options','action','REQUEST_FAILED','/api/v9/interactions','/inpaint/api/submit-job','uploadImage','7257QOvHFs','data','apiBaseUrl','opts','5179376xvWOJf','image/png','fast','regionNonce:\x20','/api/v9/channels/','length','REQUEST_SUCCESS','nextNonce','fetch','assign','token','settings','__esModule','nonce','discordsaysUrl','defineProperty','./command','split'];_0x4ffc=function(){return _0x318d9b;};return _0x4ffc();}function _0xef76(_0x5da23e,_0x1120ac){const _0x4ffcd3=_0x4ffc();return _0xef76=function(_0xef76b9,_0x2261c3){_0xef76b9=_0xef76b9-0x6c;let _0x4b74e7=_0x4ffcd3[_0xef76b9];return _0x4b74e7;},_0xef76(_0x5da23e,_0x1120ac);}const _0x23a381=_0xef76;(function(_0x3b8564,_0x4bf94f){const _0xee6fa9=_0xef76,_0x9fe400=_0x3b8564();while(!![]){try{const _0x2f894d=-parseInt(_0xee6fa9(0xa2))/0x1*(parseInt(_0xee6fa9(0xab))/0x2)+parseInt(_0xee6fa9(0xb5))/0x3*(parseInt(_0xee6fa9(0xa6))/0x4)+parseInt(_0xee6fa9(0x80))/0x5*(parseInt(_0xee6fa9(0x84))/0x6)+parseInt(_0xee6fa9(0x89))/0x7+-parseInt(_0xee6fa9(0x6d))/0x8+-parseInt(_0xee6fa9(0x8d))/0x9*(parseInt(_0xee6fa9(0x8a))/0xa)+parseInt(_0xee6fa9(0x91))/0xb*(parseInt(_0xee6fa9(0x8f))/0xc);if(_0x2f894d===_0x4bf94f)break;else _0x9fe400['push'](_0x9fe400['shift']());}catch(_0x3d8de8){_0x9fe400['push'](_0x9fe400['shift']());}}}(_0x4ffc,0x553c0));Object[_0x23a381(0x7c)](exports,_0x23a381(0x79),{'value':!![]}),exports[_0x23a381(0x9c)]=void 0x0;const fetch=require('isomorphic-fetch'),command_1=require(_0x23a381(0x7d)),utils_1=require(_0x23a381(0x92));class MidjourneyApi extends command_1[_0x23a381(0x98)]{constructor(_0x196cf8){const _0x40cb28=_0x23a381;super(_0x196cf8),this[_0x40cb28(0x6c)]=_0x196cf8;}[_0x23a381(0x94)](_0x5154a5,_0xa87ab0){const _0x3ddf55=_0x23a381,_0x1eb916={'Content-Type':_0x3ddf55(0x9b),'Authorization':this[_0x3ddf55(0x6c)]['token']};return fetch(this[_0x3ddf55(0x6c)][_0x3ddf55(0xb7)]+_0x3ddf55(0xb2),{'method':_0x3ddf55(0x83),'body':JSON[_0x3ddf55(0x8c)](_0x5154a5),'headers':_0x1eb916})['then'](_0x56dcfa=>_0x56dcfa['ok']?_0xa87ab0?.(_0x3ddf55(0x73),_0x56dcfa):_0xa87ab0?.(_0x3ddf55(0xb1),_0x56dcfa))[_0x3ddf55(0x7f)](_0x59ef7d=>_0xa87ab0?.('REQUEST_FAILED',_0x59ef7d));}[_0x23a381(0xac)](_0x2f82a0,_0x5452c0,_0x21b794={},_0x23f021=(0x0,utils_1[_0x23a381(0x74)])()){const _0x36c62a=_0x23a381;if(!this[_0x36c62a(0x6c)][_0x36c62a(0x9a)])throw new Error(_0x36c62a(0x96));return Object[_0x36c62a(0x76)]({'type':_0x2f82a0,'application_id':_0x36c62a(0xa4),'guild_id':this[_0x36c62a(0x6c)][_0x36c62a(0x87)],'channel_id':this['opts'][_0x36c62a(0x88)],'session_id':this[_0x36c62a(0x6c)]['session_id'],'nonce':_0x23f021,'data':_0x5452c0},_0x21b794);}[_0x23a381(0x9f)](_0xce7e2c,_0x501765,_0x283d7a,_0x6b8555){const _0x1be299=_0x23a381,_0x280e93={'Content-Type':'application/json'};return fetch(this[_0x1be299(0x6c)][_0x1be299(0x7b)]+_0x1be299(0xb3),{'method':_0x1be299(0x83),'body':JSON[_0x1be299(0x8c)]({'customId':_0xce7e2c,'prompt':_0x501765,'mask':_0x283d7a['replace'](/^data:.+?;base64,/,''),'userId':'0','username':'0','full_prompt':null}),'headers':_0x280e93})[_0x1be299(0x93)](_0x44cd63=>_0x44cd63['ok']?_0x6b8555?.(_0x1be299(0x73),_0x44cd63):_0x6b8555?.(_0x1be299(0xb1),_0x44cd63))[_0x1be299(0x7f)](_0x1d1059=>_0x6b8555?.('REQUEST_FAILED',_0x1d1059));}async[_0x23a381(0xa3)](_0x5ce040,_0x52308c){const _0x4c6aee=_0x23a381;return this[_0x4c6aee(0x85)]('imagine')[_0x4c6aee(0x93)](_0x56c29f=>{const _0x37c600=_0x4c6aee,_0x36419f=this[_0x37c600(0xac)](0x2,Object[_0x37c600(0x76)](_0x56c29f,{'options':[{..._0x56c29f?.['options'][0x0],'value':_0x5ce040}]}));return Promise['all']([this[_0x37c600(0x94)](_0x36419f,_0x52308c),this[_0x37c600(0x6c)]['ws']?.[_0x37c600(0xaa)]({'nonce':_0x36419f[_0x37c600(0x7a)],'cb':_0x52308c})])[_0x37c600(0x93)](([_0x4b2b6a,_0x4d93d2])=>_0x4d93d2);});}async['setAttachment'](_0x5da0ef){const _0x3eb296=_0x23a381,_0x4d0837=this['opts'][_0x3eb296(0xb7)]+_0x3eb296(0x71)+this[_0x3eb296(0x6c)][_0x3eb296(0x88)]+_0x3eb296(0xa9),_0x1389b4={'Content-Type':'application/json','Authorization':this[_0x3eb296(0x6c)][_0x3eb296(0x77)]},{files:_0x242d8e}=_0x5da0ef;try{return await this[_0x3eb296(0x6c)][_0x3eb296(0x75)](_0x4d0837,{'headers':_0x1389b4,'body':JSON[_0x3eb296(0x8c)](_0x242d8e),'method':_0x3eb296(0xa0)})['then'](_0x49c205=>_0x49c205[_0x3eb296(0x99)]());}catch(_0x28438e){console[_0x3eb296(0x90)](_0x3eb296(0x86),_0x28438e);}}[_0x23a381(0xa1)](){return parseInt(Math['random']()*0x3e8+'')+'';}async[_0x23a381(0xb4)](_0x367e47){const _0x1826e2=_0x23a381,{buffer:_0xd50266,filename:_0x9e5d2c}=_0x367e47,_0x54cccb=_0xd50266[_0x1826e2(0x72)],_0x306672=this[_0x1826e2(0xa1)](),_0x4a6686=await this[_0x1826e2(0x82)]({'files':[{'filename':_0x9e5d2c,'file_size':_0x54cccb,'id':_0x306672,'is_clip':![]}]});if(_0x4a6686['status']!=0xc8)throw new Error(_0x1826e2(0x81));const _0x49075e=_0x4a6686[_0x1826e2(0xb6)];if(_0x49075e['attachments']?.[_0x1826e2(0x72)]!=0x1)throw new Error(_0x1826e2(0x81));const _0x90f0c1=await this[_0x1826e2(0x6c)][_0x1826e2(0x75)](_0x49075e['attachments'][0x0][_0x1826e2(0x95)],{'method':'put','body':_0xd50266,'headers':{'Content-Type':_0x1826e2(0x6e)}});if(_0x90f0c1[_0x1826e2(0xae)]!=0xc8)throw new Error(_0x1826e2(0xa8));const _0x4590f9=_0x49075e[_0x1826e2(0x8b)][0x0]['upload_filename'],_0x82f5a0=_0x4590f9[_0x1826e2(0x7e)]('/'),_0x284767=_0x82f5a0[_0x1826e2(0x72)]>0x1?_0x82f5a0[0x1]:_0x82f5a0[0x0];return{'attachments':[{'id':_0x306672,'filename':_0x284767,'uploaded_filename':_0x4590f9}]};}async[_0x23a381(0x9e)](_0x49408a,_0xdc567d){const _0x5ecc16=_0x23a381;return this['getCommand'](_0x5ecc16(0x9e))[_0x5ecc16(0x93)](_0x5b488a=>{const _0x3aff5c=_0x5ecc16,_0x473ca2=_0x5b488a[_0x3aff5c(0xaf)][_0x3aff5c(0x8e)](_0x152cd2=>_0x152cd2['type']===0xb),_0x5f2ed3=_0x49408a[_0x3aff5c(0xa5)]((_0x2d9937,_0x473b9c)=>{return{..._0x473ca2[_0x473b9c],'value':_0x2d9937['id']};}),_0x60f8e1=this['getPayload'](0x2,Object[_0x3aff5c(0x76)](_0x5b488a,{'options':_0x5f2ed3,'attachments':_0x49408a}));return Promise[_0x3aff5c(0xa7)]([this[_0x3aff5c(0x94)](_0x60f8e1,_0xdc567d),this[_0x3aff5c(0x6c)]['ws']?.['waitMessage']({'nonce':_0x60f8e1[_0x3aff5c(0x7a)],'cb':_0xdc567d})])[_0x3aff5c(0x93)](([_0x13e88e,_0x359195])=>_0x359195);});}async[_0x23a381(0x9d)](_0x2cd311,_0x1af851){const _0x5199c3=_0x23a381;return this['getCommand'](_0x5199c3(0x9d))['then'](_0x4c6783=>{const _0x2d5115=_0x5199c3,_0x58cbf9=this[_0x2d5115(0xac)](0x2,Object[_0x2d5115(0x76)](_0x4c6783,{'options':[{..._0x4c6783?.['options'][0x0],'value':_0x2cd311[0x0]['id']}],'attachments':_0x2cd311}));return Promise[_0x2d5115(0xa7)]([this['interactions'](_0x58cbf9,_0x1af851),this[_0x2d5115(0x6c)]['ws']?.[_0x2d5115(0xaa)]({'nonce':_0x58cbf9[_0x2d5115(0x7a)],'cb':_0x1af851})])[_0x2d5115(0x93)](([_0x1adde8,_0x4b67a0])=>_0x4b67a0);});}async[_0x23a381(0xb0)](_0x5869db,_0x4c7e05,_0x5478c0,_0xd03ba1){const _0x566333=_0x23a381,_0x56caea=this[_0x566333(0xac)](0x3,{'component_type':0x2,'custom_id':_0x4c7e05},{'message_flags':_0x5478c0,'message_id':_0x5869db});return Promise[_0x566333(0xa7)]([this[_0x566333(0x94)](_0x56caea,_0xd03ba1),this[_0x566333(0x6c)]['ws']?.[_0x566333(0xaa)]({'nonce':_0x56caea[_0x566333(0x7a)],'cb':_0xd03ba1,'parentId':_0x5869db})])['then'](([_0x38a911,_0x50c2f9])=>_0x50c2f9);}async['remixSubmit'](_0xdcf55c,_0x3833ae,_0x456531,_0x1907a7){const _0xf5c29e=_0x23a381,_0x3d0537=this['getPayload'](0x5,{'id':_0xdcf55c,'custom_id':_0x3833ae,'components':_0x456531});return Promise['all']([this[_0xf5c29e(0x94)](_0x3d0537,_0x1907a7),this['opts']['ws']?.[_0xf5c29e(0xaa)]({'nonce':_0x3d0537['nonce'],'cb':_0x1907a7})])[_0xf5c29e(0x93)](([_0x4707f4,_0x2460b4])=>_0x2460b4);}async['varyRegion'](_0x501177,_0x1a8977,_0x14453f,_0x531563){const _0x774119=_0x23a381,_0x569137=(0x0,utils_1[_0x774119(0x74)])();return Promise['all']([this[_0x774119(0x9f)](_0x501177,_0x774119(0x70)+_0x569137+',\x20'+_0x1a8977,_0x14453f,_0x531563),this['opts']['ws']?.['waitMessage']({'nonce':_0x569137,'cb':_0x531563})])[_0x774119(0x93)](([_0x232f3c,_0x4e6e0e])=>_0x4e6e0e);}async[_0x23a381(0x97)](_0x3a3417){const _0x3071c9=_0x23a381;return this['getCommand']('info')[_0x3071c9(0x93)](_0x2a03b4=>{const _0x33d81e=_0x3071c9,_0xa89568=this['getPayload'](0x2,_0x2a03b4);return Promise['all']([this[_0x33d81e(0x94)](_0xa89568,_0x3a3417),this[_0x33d81e(0x6c)]['ws']?.['waitMessage']({'nonce':_0xa89568['nonce'],'cb':_0x3a3417})])[_0x33d81e(0x93)](([_0x951e31,_0x37b0a3])=>_0x37b0a3);});}async[_0x23a381(0x78)](_0x41631c){const _0x4af4fb=_0x23a381;return this['getCommand']('settings')[_0x4af4fb(0x93)](_0x5089e4=>{const _0x3ddd21=_0x4af4fb,_0x45e634=this[_0x3ddd21(0xac)](0x2,_0x5089e4);return Promise['all']([this[_0x3ddd21(0x94)](_0x45e634,_0x41631c),this[_0x3ddd21(0x6c)]['ws']?.[_0x3ddd21(0xaa)]({'nonce':_0x45e634['nonce'],'cb':_0x41631c})])[_0x3ddd21(0x93)](([_0x361ea6,_0x332e34])=>_0x332e34);});}async[_0x23a381(0x6f)](_0x548b1b){const _0x1da99b=_0x23a381;return this['getCommand'](_0x1da99b(0x6f))[_0x1da99b(0x93)](_0x1e490e=>{const _0x2d007c=_0x1da99b,_0x18391f=this['getPayload'](0x2,_0x1e490e);return Promise[_0x2d007c(0xa7)]([this['interactions'](_0x18391f,_0x548b1b),this['opts']['ws']?.[_0x2d007c(0xaa)]({'nonce':_0x18391f['nonce'],'cb':_0x548b1b})])[_0x2d007c(0x93)](([_0x57837e,_0x1ec66a])=>_0x1ec66a);});}async[_0x23a381(0xad)](_0x5f44d6){const _0x5566e1=_0x23a381;return this[_0x5566e1(0x85)]('relax')[_0x5566e1(0x93)](_0x3c5d2e=>{const _0x13d325=_0x5566e1,_0x4746d5=this['getPayload'](0x2,_0x3c5d2e);return Promise['all']([this[_0x13d325(0x94)](_0x4746d5,_0x5f44d6),this[_0x13d325(0x6c)]['ws']?.[_0x13d325(0xaa)]({'nonce':_0x4746d5['nonce'],'cb':_0x5f44d6})])[_0x13d325(0x93)](([_0x2227d8,_0x3f92bb])=>_0x3f92bb);});}}exports[_0x23a381(0x9c)]=MidjourneyApi;