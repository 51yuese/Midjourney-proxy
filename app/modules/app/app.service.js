'use strict';const _0x4d2b43=_0x56b6;(function(_0x57a013,_0x4eff0a){const _0x105988=_0x56b6,_0x40032c=_0x57a013();while(!![]){try{const _0x1be7d0=parseInt(_0x105988(0xbf))/0x1+parseInt(_0x105988(0x87))/0x2*(parseInt(_0x105988(0xac))/0x3)+-parseInt(_0x105988(0x95))/0x4*(-parseInt(_0x105988(0x8a))/0x5)+-parseInt(_0x105988(0xbb))/0x6+-parseInt(_0x105988(0x94))/0x7*(-parseInt(_0x105988(0x93))/0x8)+parseInt(_0x105988(0x9f))/0x9*(parseInt(_0x105988(0x98))/0xa)+-parseInt(_0x105988(0x92))/0xb;if(_0x1be7d0===_0x4eff0a)break;else _0x40032c['push'](_0x40032c['shift']());}catch(_0x4862e8){_0x40032c['push'](_0x40032c['shift']());}}}(_0x262d,0xe061f));var __decorate=this&&this['__decorate']||function(_0x29a9f4,_0x19a869,_0x3f9ed7,_0x33313a){const _0x568c38=_0x56b6;var _0x5de411=arguments[_0x568c38(0xa8)],_0x1a9344=_0x5de411<0x3?_0x19a869:_0x33313a===null?_0x33313a=Object[_0x568c38(0xbc)](_0x19a869,_0x3f9ed7):_0x33313a,_0x220fbe;if(typeof Reflect===_0x568c38(0x91)&&typeof Reflect['decorate']==='function')_0x1a9344=Reflect[_0x568c38(0x9a)](_0x29a9f4,_0x19a869,_0x3f9ed7,_0x33313a);else{for(var _0x329bee=_0x29a9f4[_0x568c38(0xa8)]-0x1;_0x329bee>=0x0;_0x329bee--)if(_0x220fbe=_0x29a9f4[_0x329bee])_0x1a9344=(_0x5de411<0x3?_0x220fbe(_0x1a9344):_0x5de411>0x3?_0x220fbe(_0x19a869,_0x3f9ed7,_0x1a9344):_0x220fbe(_0x19a869,_0x3f9ed7))||_0x1a9344;}return _0x5de411>0x3&&_0x1a9344&&Object[_0x568c38(0xa0)](_0x19a869,_0x3f9ed7,_0x1a9344),_0x1a9344;},__metadata=this&&this[_0x4d2b43(0x8d)]||function(_0x539992,_0x2aab44){const _0x444c0d=_0x4d2b43;if(typeof Reflect===_0x444c0d(0x91)&&typeof Reflect['metadata']===_0x444c0d(0xa7))return Reflect[_0x444c0d(0x88)](_0x539992,_0x2aab44);},__param=this&&this[_0x4d2b43(0x9b)]||function(_0x4770eb,_0x273832){return function(_0x3d0654,_0x3000e8){_0x273832(_0x3d0654,_0x3000e8,_0x4770eb);};};function _0x56b6(_0x1cf535,_0x229847){const _0x262dec=_0x262d();return _0x56b6=function(_0x56b663,_0x4059ee){_0x56b663=_0x56b663-0x87;let _0x235bc5=_0x262dec[_0x56b663];return _0x235bc5;},_0x56b6(_0x1cf535,_0x229847);}function _0x262d(){const _0x22d50a=['random','count','\x20OFFSET\x20','user','collectCount','@nestjs/typeorm','HttpException','\x0a\x20\x20\x20\x20\x20\x20','InjectRepository','\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gm.*,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gg.groupName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20AS\x20collectTime\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20','@nestjs/common','AppService','Repository','6338880aNlkXX','getOwnPropertyDescriptor','save','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20ORDER\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.createdAt\x20DESC\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LIMIT\x20','1563489dOdDqL','Logger','2ORpkVB','metadata','userAppsEntity','265djTgat','system','mineAppsV3','__metadata','Connection','已将应用移除我的应用!','catch','object','43597752fXiKzZ','7296368GBHxfD','14vkncHE','34616eFIaOu','GptsModelEntity','__esModule','1156030atAzzv','已将应用添加到我的应用！','decorate','__param','BAD_REQUEST','connection','HttpStatus','99VjbqWQ','defineProperty','操作失败！','groupId','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20AND\x20gm.id\x20IS\x20NOT\x20NULL\x20\x0a\x20\x20\x20\x20\x20\x20','../gpts/gpts.model.entity','query','gptsModelEntity','function','length','./userApps.entity','typeorm','log','2463321gOrPyV','delete'];_0x262d=function(){return _0x22d50a;};return _0x262d();}Object['defineProperty'](exports,_0x4d2b43(0x97),{'value':!![]}),exports[_0x4d2b43(0xb9)]=void 0x0;const common_1=require(_0x4d2b43(0xb8)),typeorm_1=require(_0x4d2b43(0xaa)),typeorm_2=require(_0x4d2b43(0xb3)),userApps_entity_1=require(_0x4d2b43(0xa9)),gpts_model_entity_1=require(_0x4d2b43(0xa4));let AppService=class AppService{constructor(_0x3f81c0,_0x26d539,_0x4bb4a5){const _0x5ab8d3=_0x4d2b43;this[_0x5ab8d3(0xa6)]=_0x3f81c0,this[_0x5ab8d3(0x89)]=_0x26d539,this[_0x5ab8d3(0x9d)]=_0x4bb4a5;}async['collect'](_0x39f569,_0x1794cd){const _0x1dcd56=_0x4d2b43,{appId:_0x6327fc}=_0x39f569,{id:_0x349127}=_0x1794cd[_0x1dcd56(0xb1)];try{const _0x3fd6c6=await this[_0x1dcd56(0x89)]['findOne']({'where':{'appId':_0x6327fc,'userId':_0x349127}})[_0x1dcd56(0x90)](_0x366379=>{const _0x40b5d8=_0x1dcd56;common_1[_0x40b5d8(0xc0)][_0x40b5d8(0xab)](_0x366379);});if(_0x3fd6c6){const _0x36ecf6=await this[_0x1dcd56(0x89)][_0x1dcd56(0xad)]({'appId':_0x6327fc,'userId':_0x349127})['catch'](_0x2705e0=>{const _0x1d57ea=_0x1dcd56;common_1[_0x1d57ea(0xc0)][_0x1d57ea(0xab)](_0x2705e0);});if(!_0x36ecf6||_0x36ecf6['affected']<=0x0)throw new common_1[(_0x1dcd56(0xb4))]('取消移除我的应用失败！',common_1[_0x1dcd56(0x9e)][_0x1dcd56(0x9c)]);return _0x1dcd56(0x8f);}const _0x46196e=await this[_0x1dcd56(0xa6)]['findOne']({'where':{'id':_0x6327fc}})[_0x1dcd56(0x90)](_0x3293bd=>{const _0x5e991b=_0x1dcd56;common_1[_0x5e991b(0xc0)][_0x5e991b(0xab)](_0x3293bd);});if(!_0x46196e)throw new common_1['HttpException'](_0x1dcd56(0xa1),common_1[_0x1dcd56(0x9e)]['BAD_REQUEST']);const _0x1319a7={'userId':_0x349127,'appId':_0x46196e['id'],'catId':_0x46196e[_0x1dcd56(0xa2)],'appRole':_0x1dcd56(0x8b),'public':!![],'status':0x1};return await this[_0x1dcd56(0x89)][_0x1dcd56(0xbd)](_0x1319a7)[_0x1dcd56(0x90)](_0x261e38=>{const _0x437b02=_0x1dcd56;common_1[_0x437b02(0xc0)]['log'](_0x261e38);}),_0x46196e[_0x1dcd56(0xb2)]=_0x46196e['collectCount']+Math['round'](Math[_0x1dcd56(0xae)]()*0xa),await this[_0x1dcd56(0xa6)][_0x1dcd56(0xbd)](_0x46196e),_0x1dcd56(0x99);}catch(_0x4a8f7e){console['log'](_0x4a8f7e);}}async[_0x4d2b43(0x8c)](_0x48604c,_0x386c8b={'page':0x1,'size':0x1e}){const _0xc15fe8=_0x4d2b43,{id:_0xed7e5c}=_0x48604c['user'],{page:page=0x1,size:size=0x1e}=_0x386c8b;try{const _0x4492a8=await this['connection'][_0xc15fe8(0xa5)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20as\x20count\x0a\x20\x20\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_apps\x20ua\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_models\x20gm\x20ON\x20ua.appId\x20=\x20gm.id\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20LEFT\x20JOIN\x20gpts_group\x20gg\x20ON\x20gm.groupId\x20=\x20gg.id\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ua.userId\x20=\x20'+_0xed7e5c+_0xc15fe8(0xa3)),_0x1b7f26=await this[_0xc15fe8(0x9d)]['query'](_0xc15fe8(0xb7)+_0xed7e5c+_0xc15fe8(0xbe)+size+_0xc15fe8(0xb0)+(page-0x1)*size+_0xc15fe8(0xb5));return{'rows':_0x1b7f26,'count':Number(_0x4492a8[0x0]?.[_0xc15fe8(0xaf)]||0x0)};}catch(_0x248655){console[_0xc15fe8(0xab)](_0x248655['message']);}}};AppService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_2[_0x4d2b43(0xb6)])(gpts_model_entity_1[_0x4d2b43(0x96)])),__param(0x1,(0x0,typeorm_2[_0x4d2b43(0xb6)])(userApps_entity_1['UserAppsEntity'])),__metadata('design:paramtypes',[typeorm_1[_0x4d2b43(0xba)],typeorm_1[_0x4d2b43(0xba)],typeorm_1[_0x4d2b43(0x8e)]])],AppService),exports[_0x4d2b43(0xb9)]=AppService;