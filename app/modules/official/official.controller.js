'use strict';const _0x473c89=_0x191d;(function(_0x211bfa,_0x61cc01){const _0x1dc411=_0x191d,_0x2d0481=_0x211bfa();while(!![]){try{const _0x4fecab=-parseInt(_0x1dc411(0x1c6))/0x1*(parseInt(_0x1dc411(0x191))/0x2)+-parseInt(_0x1dc411(0x1ce))/0x3*(parseInt(_0x1dc411(0x1a2))/0x4)+-parseInt(_0x1dc411(0x1ba))/0x5+-parseInt(_0x1dc411(0x1da))/0x6*(-parseInt(_0x1dc411(0x19a))/0x7)+-parseInt(_0x1dc411(0x188))/0x8*(parseInt(_0x1dc411(0x185))/0x9)+-parseInt(_0x1dc411(0x1b2))/0xa+parseInt(_0x1dc411(0x1b1))/0xb*(parseInt(_0x1dc411(0x1d6))/0xc);if(_0x4fecab===_0x61cc01)break;else _0x2d0481['push'](_0x2d0481['shift']());}catch(_0x403c8f){_0x2d0481['push'](_0x2d0481['shift']());}}}(_0x181e,0x3351e));var __decorate=this&&this[_0x473c89(0x198)]||function(_0x2ead92,_0x1dfdf4,_0x12ffd4,_0x946abd){const _0x2c75c8=_0x473c89;var _0x260e93=arguments[_0x2c75c8(0x1e5)],_0x397d96=_0x260e93<0x3?_0x1dfdf4:_0x946abd===null?_0x946abd=Object[_0x2c75c8(0x1d7)](_0x1dfdf4,_0x12ffd4):_0x946abd,_0x33da11;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x2c75c8(0x18d))_0x397d96=Reflect[_0x2c75c8(0x1d5)](_0x2ead92,_0x1dfdf4,_0x12ffd4,_0x946abd);else{for(var _0x5249b3=_0x2ead92[_0x2c75c8(0x1e5)]-0x1;_0x5249b3>=0x0;_0x5249b3--)if(_0x33da11=_0x2ead92[_0x5249b3])_0x397d96=(_0x260e93<0x3?_0x33da11(_0x397d96):_0x260e93>0x3?_0x33da11(_0x1dfdf4,_0x12ffd4,_0x397d96):_0x33da11(_0x1dfdf4,_0x12ffd4))||_0x397d96;}return _0x260e93>0x3&&_0x397d96&&Object['defineProperty'](_0x1dfdf4,_0x12ffd4,_0x397d96),_0x397d96;},__metadata=this&&this['__metadata']||function(_0x3b3b3f,_0x3a927d){const _0x5d0df1=_0x473c89;if(typeof Reflect===_0x5d0df1(0x18e)&&typeof Reflect[_0x5d0df1(0x1d4)]===_0x5d0df1(0x18d))return Reflect[_0x5d0df1(0x1d4)](_0x3b3b3f,_0x3a927d);},__param=this&&this[_0x473c89(0x195)]||function(_0x12b990,_0x3cc6ad){return function(_0x5697e9,_0x2303a5){_0x3cc6ad(_0x5697e9,_0x2303a5,_0x12b990);};};Object[_0x473c89(0x1ca)](exports,'__esModule',{'value':!![]}),exports['OfficialController']=void 0x0;const common_1=require(_0x473c89(0x184)),swagger_1=require('@nestjs/swagger'),jwtAuth_guard_1=require(_0x473c89(0x1e0)),official_service_1=require('./official.service'),axios_1=require(_0x473c89(0x192)),getQrCode_dto_1=require('./dto/getQrCode.dto'),getQrSceneStr_dto_1=require('./dto/getQrSceneStr.dto'),Login_vo_1=require(_0x473c89(0x181));function _0x181e(){const _0x2606d3=['genXmlMsgByConfig','UseGuards','ApiOperation','loginBySceneStr','OfficialLoginVO','407mnYRrY','2114500ShxLtU','Controller','default','includes','eventkey','timestamp','officialSubscribeText','gomaxai.qumao518.vip','933060rVyYtd','Body','design:type','send','sceneStr:\x20','getRedirectUrl','getQRCodeTicket','design:returntype','content','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','Req','verify','301958KmqqEG','公众号通知接口POST','officialBindAccountText','split','defineProperty','getAccessToken','officialScanLoginText','scanBindWx','87misDNg','getQRSceneStr','event','prototype','subscribe','status','metadata','decorate','427296ExNFwn','getOwnPropertyDescriptor','扫码登录轮询查询','getJsapiTicket','169860AJhcxb','env','ceshi.qumao518.vip：广播扫码事件失败','getQRSceneStrByBind','GetQrCodeDto','获取登录二维码sceneStr','../../common/auth/jwtAuth.guard','VIEW','type','ApiResponse','code','length','notify','bindWxBySceneStr','获取注册配置','loginByCode','aotoPlay','msgtype','signature','./vo/Login.vo','fromusername','url','@nestjs/common','9UGbKgO','error','sceneStr','1833128LdgaLN','notifyPost','genXmlMsg','Logger','design:paramtypes','function','object','application/json','CLICK','2VzKiCO','axios','JwtAuthGuard','catch','__param','POST','official','__decorate','Post','21mDUYAu','Query','ApiTags','qrscene_','log','SCAN','text','offical\x20getQRCode','36284mMcqom','https://kaifa.qumao518.vip/api/official/notify','getQRCode','echostr','Get','scan','unsubscribe','success','OfficialController','officialService'];_0x181e=function(){return _0x2606d3;};return _0x181e();}let OfficialController=class OfficialController{constructor(_0x222ecd){const _0x29c424=_0x473c89;this[_0x29c424(0x1ab)]=_0x222ecd;}async[_0x473c89(0x1e6)](_0x34c8e7,_0x385035,_0x9c8647){const _0x5031f2=_0x473c89;console[_0x5031f2(0x19e)]('get\x20通知>>>',_0x385035,_0x9c8647);const _0x22e3cd=await this[_0x5031f2(0x1ab)][_0x5031f2(0x1c5)](_0x385035[_0x5031f2(0x180)],_0x385035['nonce'],_0x385035[_0x5031f2(0x1b7)]);return _0x22e3cd?_0x385035[_0x5031f2(0x1a5)]:'';}async[_0x473c89(0x189)](_0x91df9c,_0x3ebb35,_0xdd2010,_0x2878d7){const _0x123bea=_0x473c89,{xml:_0xa90004}=_0xdd2010;console[_0x123bea(0x19e)]('xml:\x20',_0xa90004);const _0x272eca=process[_0x123bea(0x1db)]['GOMAXAI_HOST'];_0x272eca===_0x123bea(0x1b9)&&((0x0,axios_1[_0x123bea(0x1b4)])({'url':_0x123bea(0x1a3),'data':_0xdd2010,'method':_0x123bea(0x196),'headers':{'Content-Type':_0x123bea(0x18f)}})[_0x123bea(0x194)](_0x33b610=>{console['error']('kaifa.qumao518.vip：广播扫码事件失败');}),(0x0,axios_1[_0x123bea(0x1b4)])({'url':'https://ceshi.qumao518.vip/api/official/notify','data':_0xdd2010,'method':_0x123bea(0x196),'headers':{'Content-Type':_0x123bea(0x18f)}})[_0x123bea(0x194)](_0x4de9f4=>{const _0x20640b=_0x123bea;console[_0x20640b(0x186)](_0x20640b(0x1dc));}),(0x0,axios_1[_0x123bea(0x1b4)])({'url':'https://saas.qumao518.vip/api/official/notify','data':_0xdd2010,'method':'POST','headers':{'Content-Type':_0x123bea(0x18f)}})[_0x123bea(0x194)](_0x511a6c=>{const _0x565bb3=_0x123bea;console[_0x565bb3(0x186)]('saas.qumao518.vip：广播扫码事件失败');}));if(_0xa90004[_0x123bea(0x17f)][0x0]==_0x123bea(0x1d0)){if(_0xa90004[_0x123bea(0x1d0)][0x0]==_0x123bea(0x1e1)||_0xa90004[_0x123bea(0x1d0)][0x0]==_0x123bea(0x190))return _0x2878d7[_0x123bea(0x1d3)](0xc8)[_0x123bea(0x1bd)]('');if(_0xa90004[_0x123bea(0x1d0)][0x0]==_0x123bea(0x19f)){console[_0x123bea(0x19e)]('扫码');const _0x21042d=_0xa90004[_0x123bea(0x1b6)][0x0];if(_0x21042d[_0x123bea(0x1b5)]('/')){this['officialService'][_0x123bea(0x1cd)](_0xa90004[_0x123bea(0x182)][0x0],_0x21042d);const _0x1719ef=await this['officialService']['genXmlMsgByConfig'](_0xa90004,_0x123bea(0x1c8));return _0x2878d7[_0x123bea(0x1d3)](0xc8)[_0x123bea(0x1bd)](_0x1719ef);}this[_0x123bea(0x1ab)][_0x123bea(0x1a7)](_0xa90004[_0x123bea(0x182)][0x0],_0x21042d);const _0x4b1be4=await this[_0x123bea(0x1ab)][_0x123bea(0x1ac)](_0xa90004,_0x123bea(0x1cc));return _0x2878d7[_0x123bea(0x1d3)](0xc8)[_0x123bea(0x1bd)](_0x4b1be4);}if(_0xa90004[_0x123bea(0x1d0)][0x0]==_0x123bea(0x1d2)){console[_0x123bea(0x19e)]('订阅',_0xa90004[_0x123bea(0x1b6)][0x0]);const _0x59fa10=_0xa90004[_0x123bea(0x1b6)][0x0][_0x123bea(0x1c9)](_0x123bea(0x19d))[0x1];console['log'](_0x123bea(0x1be),_0x59fa10);if(!_0x59fa10){const _0x2556de=await this[_0x123bea(0x1ab)][_0x123bea(0x1ac)](_0xa90004,_0x123bea(0x1b8));return _0x2878d7[_0x123bea(0x1d3)](0xc8)[_0x123bea(0x1bd)](_0x2556de);}if(_0x59fa10[_0x123bea(0x1b5)]('/')){this['officialService'][_0x123bea(0x1cd)](_0xa90004[_0x123bea(0x182)][0x0],_0x59fa10);const _0x392684=await this[_0x123bea(0x1ab)][_0x123bea(0x1ac)](_0xa90004,_0x123bea(0x1c8));return _0x2878d7[_0x123bea(0x1d3)](0xc8)[_0x123bea(0x1bd)](_0x392684);}this[_0x123bea(0x1ab)]['scan'](_0xa90004[_0x123bea(0x182)][0x0],_0x59fa10);const _0x27cb1e=await this[_0x123bea(0x1ab)][_0x123bea(0x1ac)](_0xa90004,_0x123bea(0x1b8));return _0x2878d7[_0x123bea(0x1d3)](0xc8)['send'](_0x27cb1e);}if(_0xa90004[_0x123bea(0x1d0)][0x0]==_0x123bea(0x1a8))return _0x2878d7[_0x123bea(0x1d3)](0xc8)[_0x123bea(0x1bd)]('');}if(_0xa90004[_0x123bea(0x17f)][0x0]==_0x123bea(0x1a0)){console['log']('客户端发送了文字消息');const _0x186fca=await this[_0x123bea(0x1ab)][_0x123bea(0x1ea)](_0xa90004[_0x123bea(0x1c2)][0x0]),_0x12b4bf=await this['officialService'][_0x123bea(0x18a)](_0xa90004,_0x186fca);return _0x2878d7[_0x123bea(0x1d3)](0xc8)[_0x123bea(0x1bd)](_0x12b4bf);}return _0x123bea(0x1a9);}async[_0x473c89(0x1cf)](_0x393393){const _0x1feeb1=_0x473c89;return this[_0x1feeb1(0x1ab)][_0x1feeb1(0x1cf)](_0x393393);}async['getQRSceneStrByBind'](_0x22c203){const _0x2db2b3=_0x473c89;return this[_0x2db2b3(0x1ab)]['getQRSceneStrByBind'](_0x22c203);}async['getQRCode'](_0x2d1fe9){const _0x2bf052=_0x473c89,_0x44a11c=await this[_0x2bf052(0x1ab)][_0x2bf052(0x1c0)](_0x2d1fe9[_0x2bf052(0x187)]);return common_1[_0x2bf052(0x18b)][_0x2bf052(0x19e)](_0x44a11c,_0x2bf052(0x1a1)),_0x2bf052(0x1c3)+encodeURIComponent(_0x44a11c);}async['loginBySceneStr'](_0x57b27f,_0x3cbebc){const _0xdb578d=_0x473c89;return this[_0xdb578d(0x1ab)][_0xdb578d(0x1af)](_0x57b27f,_0x3cbebc[_0xdb578d(0x187)]);}async[_0x473c89(0x1e7)](_0x4dde39,_0x58333b){const _0x434aea=_0x473c89;return this[_0x434aea(0x1ab)][_0x434aea(0x1e7)](_0x4dde39,_0x58333b[_0x434aea(0x187)]);}async['getRedirectUrl'](_0x37d386){const _0x542e59=_0x473c89;return this[_0x542e59(0x1ab)][_0x542e59(0x1bf)](_0x37d386[_0x542e59(0x183)]);}async[_0x473c89(0x1d9)](_0x145beb){const _0x2e1d37=_0x473c89;return this[_0x2e1d37(0x1ab)][_0x2e1d37(0x1d9)](_0x145beb['url']);}async[_0x473c89(0x1e9)](_0x37b0d0,_0x2815d6){const _0x5262d0=_0x473c89;return this[_0x5262d0(0x1ab)][_0x5262d0(0x1e9)](_0x37b0d0,_0x2815d6[_0x5262d0(0x1e4)]);}async[_0x473c89(0x1cb)](_0x584b7f,_0x3d8267){const _0x38b977=_0x473c89;return this[_0x38b977(0x1ab)][_0x38b977(0x1cb)](_0x584b7f,_0x3d8267);}};function _0x191d(_0x22a434,_0x8ece99){const _0x181e19=_0x181e();return _0x191d=function(_0x191dc4,_0x239b49){_0x191dc4=_0x191dc4-0x17f;let _0x491553=_0x181e19[_0x191dc4];return _0x491553;},_0x191d(_0x22a434,_0x8ece99);}__decorate([(0x0,common_1[_0x473c89(0x1a6)])(_0x473c89(0x1e6)),(0x0,swagger_1[_0x473c89(0x1ae)])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1[_0x473c89(0x1c4)])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x473c89(0x1bb)])()),__metadata(_0x473c89(0x1bc),Function),__metadata(_0x473c89(0x18c),[Object,Object,Object]),__metadata(_0x473c89(0x1c1),Promise)],OfficialController[_0x473c89(0x1d1)],_0x473c89(0x1e6),null),__decorate([(0x0,common_1[_0x473c89(0x199)])('notify'),(0x0,swagger_1[_0x473c89(0x1ae)])({'summary':_0x473c89(0x1c7)}),__param(0x0,(0x0,common_1[_0x473c89(0x1c4)])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x473c89(0x1bb)])()),__param(0x3,(0x0,common_1['Res'])()),__metadata(_0x473c89(0x1bc),Function),__metadata('design:paramtypes',[Object,Object,Object,Object]),__metadata(_0x473c89(0x1c1),Promise)],OfficialController[_0x473c89(0x1d1)],_0x473c89(0x189),null),__decorate([(0x0,common_1[_0x473c89(0x199)])(_0x473c89(0x1cf)),(0x0,swagger_1[_0x473c89(0x1ae)])({'summary':_0x473c89(0x1df)}),__param(0x0,(0x0,common_1[_0x473c89(0x1bb)])()),__metadata(_0x473c89(0x1bc),Function),__metadata(_0x473c89(0x18c),[getQrSceneStr_dto_1['GetQrSceneStrDto']]),__metadata(_0x473c89(0x1c1),Promise)],OfficialController[_0x473c89(0x1d1)],_0x473c89(0x1cf),null),__decorate([(0x0,common_1[_0x473c89(0x199)])(_0x473c89(0x1dd)),(0x0,swagger_1[_0x473c89(0x1ae)])({'summary':'获取绑定二维码的sceneStr'}),(0x0,common_1[_0x473c89(0x1ad)])(jwtAuth_guard_1[_0x473c89(0x193)]),__param(0x0,(0x0,common_1['Req'])()),__metadata(_0x473c89(0x1bc),Function),__metadata(_0x473c89(0x18c),[Object]),__metadata(_0x473c89(0x1c1),Promise)],OfficialController[_0x473c89(0x1d1)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1['Get'])('getQRCode'),(0x0,swagger_1[_0x473c89(0x1ae)])({'summary':'获取二维码'}),__param(0x0,(0x0,common_1[_0x473c89(0x19b)])()),__metadata(_0x473c89(0x1bc),Function),__metadata(_0x473c89(0x18c),[getQrCode_dto_1[_0x473c89(0x1de)]]),__metadata(_0x473c89(0x1c1),Promise)],OfficialController['prototype'],_0x473c89(0x1a4),null),__decorate([(0x0,common_1[_0x473c89(0x199)])(_0x473c89(0x1af)),(0x0,swagger_1[_0x473c89(0x1ae)])({'summary':_0x473c89(0x1d8)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x473c89(0x1bb)])()),__metadata('design:type',Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata('design:returntype',Promise)],OfficialController[_0x473c89(0x1d1)],_0x473c89(0x1af),null),__decorate([(0x0,common_1[_0x473c89(0x199)])(_0x473c89(0x1e7)),(0x0,swagger_1['ApiOperation'])({'summary':'扫码绑定轮询查询'}),(0x0,common_1[_0x473c89(0x1ad)])(jwtAuth_guard_1[_0x473c89(0x193)]),__param(0x0,(0x0,common_1[_0x473c89(0x1c4)])()),__param(0x1,(0x0,common_1[_0x473c89(0x1bb)])()),__metadata(_0x473c89(0x1bc),Function),__metadata('design:paramtypes',[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x473c89(0x1c1),Promise)],OfficialController['prototype'],_0x473c89(0x1e7),null),__decorate([(0x0,common_1[_0x473c89(0x199)])(_0x473c89(0x1bf)),(0x0,swagger_1[_0x473c89(0x1ae)])({'summary':'获取登录跳转地址'}),__param(0x0,(0x0,common_1[_0x473c89(0x1bb)])()),__metadata('design:type',Function),__metadata(_0x473c89(0x18c),[Object]),__metadata(_0x473c89(0x1c1),Promise)],OfficialController[_0x473c89(0x1d1)],'getRedirectUrl',null),__decorate([(0x0,common_1[_0x473c89(0x199)])(_0x473c89(0x1d9)),(0x0,swagger_1[_0x473c89(0x1ae)])({'summary':_0x473c89(0x1e8)}),__param(0x0,(0x0,common_1[_0x473c89(0x1bb)])()),__metadata(_0x473c89(0x1bc),Function),__metadata(_0x473c89(0x18c),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x473c89(0x1d1)],_0x473c89(0x1d9),null),__decorate([(0x0,common_1[_0x473c89(0x199)])(_0x473c89(0x1e9)),(0x0,swagger_1[_0x473c89(0x1ae)])({'summary':'公众号静默登录'}),(0x0,swagger_1[_0x473c89(0x1e3)])({'type':Login_vo_1[_0x473c89(0x1b0)]}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x473c89(0x1bc),Function),__metadata('design:paramtypes',[Object,Object]),__metadata(_0x473c89(0x1c1),Promise)],OfficialController[_0x473c89(0x1d1)],'loginByCode',null),__decorate([(0x0,common_1['Get'])(_0x473c89(0x1cb)),__param(0x0,(0x0,common_1[_0x473c89(0x1c4)])()),__param(0x1,(0x0,common_1[_0x473c89(0x19b)])(_0x473c89(0x1e2))),__metadata(_0x473c89(0x1bc),Function),__metadata(_0x473c89(0x18c),[Object,String]),__metadata('design:returntype',Promise)],OfficialController[_0x473c89(0x1d1)],_0x473c89(0x1cb),null),OfficialController=__decorate([(0x0,swagger_1[_0x473c89(0x19c)])('official'),(0x0,common_1[_0x473c89(0x1b3)])(_0x473c89(0x197)),__metadata(_0x473c89(0x18c),[official_service_1['OfficialService']])],OfficialController),exports[_0x473c89(0x1aa)]=OfficialController;