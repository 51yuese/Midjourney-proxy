'use strict';const _0x11b5c8=_0x57de;(function(_0x24ae26,_0x3c5368){const _0x94046=_0x57de,_0x52a141=_0x24ae26();while(!![]){try{const _0x5d93fd=parseInt(_0x94046(0x17c))/0x1+-parseInt(_0x94046(0x17e))/0x2+parseInt(_0x94046(0x186))/0x3*(parseInt(_0x94046(0x138))/0x4)+-parseInt(_0x94046(0x16d))/0x5*(parseInt(_0x94046(0x148))/0x6)+parseInt(_0x94046(0x1a7))/0x7*(-parseInt(_0x94046(0x160))/0x8)+-parseInt(_0x94046(0x191))/0x9*(-parseInt(_0x94046(0x15d))/0xa)+-parseInt(_0x94046(0x136))/0xb;if(_0x5d93fd===_0x3c5368)break;else _0x52a141['push'](_0x52a141['shift']());}catch(_0x448097){_0x52a141['push'](_0x52a141['shift']());}}}(_0xece3,0x6cc05));var __decorate=this&&this[_0x11b5c8(0x165)]||function(_0x2a95c5,_0x12f33d,_0x1afd9e,_0x5df7e8){const _0x3a291c=_0x11b5c8;var _0x5157d4=arguments['length'],_0x32eba9=_0x5157d4<0x3?_0x12f33d:_0x5df7e8===null?_0x5df7e8=Object[_0x3a291c(0x1ad)](_0x12f33d,_0x1afd9e):_0x5df7e8,_0x34bb29;if(typeof Reflect===_0x3a291c(0x14e)&&typeof Reflect[_0x3a291c(0x14d)]==='function')_0x32eba9=Reflect[_0x3a291c(0x14d)](_0x2a95c5,_0x12f33d,_0x1afd9e,_0x5df7e8);else{for(var _0x26ab71=_0x2a95c5['length']-0x1;_0x26ab71>=0x0;_0x26ab71--)if(_0x34bb29=_0x2a95c5[_0x26ab71])_0x32eba9=(_0x5157d4<0x3?_0x34bb29(_0x32eba9):_0x5157d4>0x3?_0x34bb29(_0x12f33d,_0x1afd9e,_0x32eba9):_0x34bb29(_0x12f33d,_0x1afd9e))||_0x32eba9;}return _0x5157d4>0x3&&_0x32eba9&&Object[_0x3a291c(0x193)](_0x12f33d,_0x1afd9e,_0x32eba9),_0x32eba9;},__metadata=this&&this[_0x11b5c8(0x16f)]||function(_0x242457,_0xd14133){const _0x7752cc=_0x11b5c8;if(typeof Reflect===_0x7752cc(0x14e)&&typeof Reflect[_0x7752cc(0x14a)]===_0x7752cc(0x194))return Reflect[_0x7752cc(0x14a)](_0x242457,_0xd14133);},__param=this&&this[_0x11b5c8(0x156)]||function(_0x148c43,_0x168d90){return function(_0x17a55e,_0x4e1a50){_0x168d90(_0x17a55e,_0x4e1a50,_0x148c43);};};function _0x57de(_0x19e2ad,_0x4ef51a){const _0xece3f1=_0xece3();return _0x57de=function(_0x57de4e,_0x353e2b){_0x57de4e=_0x57de4e-0x125;let _0x14a442=_0xece3f1[_0x57de4e];return _0x14a442;},_0x57de(_0x19e2ad,_0x4ef51a);}function _0xece3(){const _0x56c5ec=['countNewDrawsToday','getConfigByKeys','countChatsByTimeRange','date','\x0a\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20DATE_FORMAT(\x20createdAt,\x20\x27','InjectRepository','midjourney.status\x20=\x20:status','1433733RGgIZG','baiduSiteId','axios','Not','DATE(chatlog.createdAt)\x20as\x20date,\x20COUNT(*)\x20as\x20count','startTime','getOwnPropertyDescriptor','count','now','../chatLog/chatLog.entity','BAD_REQUEST','__esModule','\x27\x20\x0a\x20\x20\x20\x20\x20\x20GROUP\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName\x20\x0a\x20\x20\x20\x20\x20\x20ORDER\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName;\x0a\x20\x20\x20\x20','countTotalMusic','get','OrderEntity','../../common/utils/date','default','getDate','clsService','sum','createQueryBuilder','Between','GlobalConfigService','\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20<=\x20\x27','countUsers','IsNull','&site_id=','931986bFBhHs','chatLogEntity','12bIcYQt','ClsService','modelUse','countNewChatsToday','HttpException','midjourney.saasId\x20=\x20:saasId','orderEntity','MUSIC','nestjs-cls','startOf','setDate','Repository','countNewUsersToday','toDate','请先配置百度统计accessToken','globalConfigService','6eUtapW','midjourney','metadata','Connection','%Y-%m-%d\x20%H:00','decorate','object','MidjourneyStatusEnum','百度授权码过期','orderBy','pv_count,visitor_count,ip_count,bounce_ratio,avg_visit_time','price','chatlog.type\x20=\x20:type','HttpStatus','__param','endOf','countTodayCollection','EModelType','countDraws','\x27\x20\x0a\x20\x20\x20\x20\x20\x20GROUP\x20BY\x0a\x20\x20\x20\x20\x20\x20\x20\x20groupeName\x0a\x20\x20\x20\x20','UserEntity','710yfaiTf','andWhere','baiduToken','24JBqHoa','getChatStatistic','value','&end_date=','countMjDrawsByTimeRange','__decorate','请先配置百度统计siteId','../../common/utils','%Y-%m-%d','connection','YYYYMMDD','../../common/constants/model.constant','formatDate','598505oIAJUy','countTodayMusic','__metadata','chatlog','@nestjs/common','toFixed','countNewMidhourneysToday','DeductionKey','M.DD','countTotalCollection','chatlog.createdAt\x20>=\x20:startDate','midjourney.createdAt\x20>=\x20:startDate','userEntity','diff','query','852604vJebiF','DATE(midjourney.createdAt)\x20as\x20date,\x20COUNT(*)\x20as\x20count','219204zwOlUh','countDrawsByTimeRange','groupBy','saasId','MidjourneyEntity','获取百度统计数据失败','CHAT_TYPE','countNewOrdersToday','382806aidqom','countOrders','getReqSaasId','getRawMany','StatisticService','subtract','PAINT_TYPE','map','design:paramtypes','https://openapi.baidu.com/rest/2.0/tongji/report/getData?access_token=','day','17559CWEXhp','endTime','defineProperty','function','typeorm','&method=','countChats','select','where','data','find','../midjourney/midjourney.entity','push','midjourneyEntity','chatlog.saasId\x20=\x20:saasId'];_0xece3=function(){return _0x56c5ec;};return _0xece3();}Object[_0x11b5c8(0x193)](exports,_0x11b5c8(0x125),{'value':!![]}),exports['StatisticService']=void 0x0;const common_1=require(_0x11b5c8(0x171)),typeorm_1=require('@nestjs/typeorm'),user_entity_1=require('../user/user.entity'),typeorm_2=require(_0x11b5c8(0x195)),chatLog_entity_1=require(_0x11b5c8(0x1b0)),balance_constant_1=require('../../common/constants/balance.constant'),date_1=require(_0x11b5c8(0x12a)),axios_1=require(_0x11b5c8(0x1a9)),order_entity_1=require('../order/order.entity'),midjourney_entity_1=require(_0x11b5c8(0x19c)),midjourney_constant_1=require('../../common/constants/midjourney.constant'),model_constant_1=require(_0x11b5c8(0x16b)),globalConfig_service_1=require('../globalConfig/globalConfig.service'),nestjs_cls_1=require(_0x11b5c8(0x140)),utils_1=require(_0x11b5c8(0x167));let StatisticService=class StatisticService{constructor(_0x392466,_0x4a4430,_0x86fa5d,_0x1b65f2,_0x3a1b42,_0x17909c,_0x41b703){const _0x90dc1a=_0x11b5c8;this[_0x90dc1a(0x179)]=_0x392466,this[_0x90dc1a(0x137)]=_0x4a4430,this[_0x90dc1a(0x13e)]=_0x86fa5d,this[_0x90dc1a(0x19e)]=_0x1b65f2,this[_0x90dc1a(0x147)]=_0x3a1b42,this[_0x90dc1a(0x12d)]=_0x17909c,this[_0x90dc1a(0x169)]=_0x41b703;}async['getBaseStatistic'](_0x430cfd){const _0x310240=_0x11b5c8,_0x1c1d8c=(0x0,utils_1[_0x310240(0x188)])(this[_0x310240(0x12d)]);_0x1c1d8c!==0x0&&(_0x430cfd=_0x1c1d8c);const _0x119ce2=await this[_0x310240(0x133)](_0x430cfd),_0x914555=await this[_0x310240(0x144)](_0x430cfd),_0x3caa8b=await this[_0x310240(0x197)](_0x430cfd),_0x5b2d6b=await this[_0x310240(0x13b)](_0x430cfd),_0x2b3552=await this[_0x310240(0x15a)](_0x430cfd),_0x372886=await this[_0x310240(0x1a0)](_0x430cfd),_0x1181c9=await this[_0x310240(0x173)](_0x430cfd),_0x446d2b=await this[_0x310240(0x187)](_0x430cfd),_0x2e1fae=await this[_0x310240(0x185)](_0x430cfd),_0x5ed7d5=await this[_0x310240(0x158)](_0x430cfd),_0xcccf5d=await this[_0x310240(0x176)](_0x430cfd),_0x54dc60=await this[_0x310240(0x16e)](_0x430cfd),_0x37e219=await this[_0x310240(0x127)](_0x430cfd);return{'userCount':_0x119ce2,'newUserCount':_0x914555,'chatCount':_0x3caa8b,'newChatCount':_0x5b2d6b,'drawCount':_0x2b3552,'newDrawCount':_0x1181c9+_0x372886,'orderCount':_0x446d2b,'newOrderCount':_0x2e1fae,'todayBrokerage':0x0,'totalBrokerage':0x0,'todayCollection':_0x5ed7d5,'totalCollection':_0xcccf5d,'todayMusic':_0x54dc60,'totalMusic':_0x37e219,'todayVideo':0x0,'totalVideo':0x0};}async['countUsers'](_0x19af0d){const _0x3f99bc=_0x11b5c8,_0x3a90d8={};_0x19af0d!==undefined&&(_0x3a90d8['saasId']=_0x19af0d);const _0x449aa5=await this[_0x3f99bc(0x179)][_0x3f99bc(0x1ae)]({'where':_0x3a90d8});return _0x449aa5;}async[_0x11b5c8(0x144)](_0xb21356){const _0x4b1fd0=_0x11b5c8,_0xa9405e=(0x0,date_1[_0x4b1fd0(0x12b)])()[_0x4b1fd0(0x141)]('d')[_0x4b1fd0(0x145)](),_0xaab1b1=(0x0,date_1[_0x4b1fd0(0x12b)])()[_0x4b1fd0(0x157)]('d')[_0x4b1fd0(0x145)](),_0xba417d={'createdAt':(0x0,typeorm_2[_0x4b1fd0(0x130)])(_0xa9405e,_0xaab1b1)};_0xb21356!==undefined&&(_0xba417d['saasId']=_0xb21356);const _0x384c53=await this[_0x4b1fd0(0x179)]['count']({'where':_0xba417d});return _0x384c53;}async[_0x11b5c8(0x197)](_0x5541eb){const _0x1ca4c3=_0x11b5c8,_0x21c0ee={'type':balance_constant_1[_0x1ca4c3(0x174)]['CHAT_TYPE']};_0x5541eb!==undefined&&(_0x21c0ee[_0x1ca4c3(0x181)]=_0x5541eb);const _0x2c5cf5=await this[_0x1ca4c3(0x137)][_0x1ca4c3(0x1ae)]({'where':_0x21c0ee});return _0x2c5cf5;}async['countNewChatsToday'](_0x56367f){const _0x63816a=_0x11b5c8,_0x4d7b39=(0x0,date_1[_0x63816a(0x12b)])()[_0x63816a(0x141)]('d')[_0x63816a(0x145)](),_0x53274c=(0x0,date_1['default'])()[_0x63816a(0x157)]('d')[_0x63816a(0x145)](),_0x318d2e={'type':balance_constant_1[_0x63816a(0x174)][_0x63816a(0x184)],'createdAt':(0x0,typeorm_2['Between'])(_0x4d7b39,_0x53274c)};_0x56367f!==undefined&&(_0x318d2e[_0x63816a(0x181)]=_0x56367f);const _0x3c5bd9=await this[_0x63816a(0x137)][_0x63816a(0x1ae)]({'where':_0x318d2e});return _0x3c5bd9;}async[_0x11b5c8(0x15a)](_0x148e9d){const _0x5d7ba1=_0x11b5c8,_0x396a94={'type':balance_constant_1[_0x5d7ba1(0x174)]['PAINT_TYPE']};_0x148e9d!==undefined&&(_0x396a94[_0x5d7ba1(0x181)]=_0x148e9d);const _0x9493ea=await this[_0x5d7ba1(0x137)]['count']({'where':_0x396a94});return _0x9493ea;}async[_0x11b5c8(0x1a0)](_0x44c64a){const _0x5925bd=_0x11b5c8,_0x54b91b=(0x0,date_1[_0x5925bd(0x12b)])()['startOf']('d')['toDate'](),_0x593b63=(0x0,date_1[_0x5925bd(0x12b)])()[_0x5925bd(0x157)]('d')[_0x5925bd(0x145)](),_0x7f06a2={'type':balance_constant_1[_0x5925bd(0x174)][_0x5925bd(0x18c)],'createdAt':(0x0,typeorm_2[_0x5925bd(0x130)])(_0x54b91b,_0x593b63)};_0x44c64a!==undefined&&(_0x7f06a2[_0x5925bd(0x181)]=_0x44c64a);const _0x3436ae=await this[_0x5925bd(0x137)][_0x5925bd(0x1ae)]({'where':_0x7f06a2});return _0x3436ae;}async[_0x11b5c8(0x173)](_0x147026){const _0x3f60f1=_0x11b5c8,_0x5c83e8=(0x0,date_1[_0x3f60f1(0x12b)])()[_0x3f60f1(0x141)]('d')['toDate'](),_0x2457ea=(0x0,date_1[_0x3f60f1(0x12b)])()['endOf']('d')[_0x3f60f1(0x145)](),_0x499706={'createdAt':(0x0,typeorm_2[_0x3f60f1(0x130)])(_0x5c83e8,_0x2457ea)};_0x147026!==undefined&&(_0x499706['saasId']=_0x147026);const _0x3d858c=await this[_0x3f60f1(0x19e)]['count']({'where':_0x499706});return _0x3d858c;}async[_0x11b5c8(0x187)](_0x405a80){const _0x57cace=_0x11b5c8,_0x1783b1={};_0x405a80!==undefined&&(_0x1783b1[_0x57cace(0x181)]=_0x405a80);const _0x4fd71d=await this[_0x57cace(0x13e)][_0x57cace(0x1ae)]({'where':_0x1783b1});return _0x4fd71d;}async[_0x11b5c8(0x185)](_0x34fa04){const _0x3abe0e=_0x11b5c8,_0x479a61=(0x0,date_1[_0x3abe0e(0x12b)])()[_0x3abe0e(0x141)]('d')[_0x3abe0e(0x145)](),_0x51d988=(0x0,date_1[_0x3abe0e(0x12b)])()[_0x3abe0e(0x157)]('d')[_0x3abe0e(0x145)](),_0x35f90f={'createdAt':(0x0,typeorm_2[_0x3abe0e(0x130)])(_0x479a61,_0x51d988)};_0x34fa04!==undefined&&(_0x35f90f[_0x3abe0e(0x181)]=_0x34fa04);const _0x36bb89=await this['orderEntity'][_0x3abe0e(0x1ae)]({'where':_0x35f90f});return _0x36bb89;}async[_0x11b5c8(0x16e)](_0x2aa890){const _0x36de16=_0x11b5c8,_0x4a07d5=(0x0,date_1['default'])()[_0x36de16(0x141)]('d')[_0x36de16(0x145)](),_0xd6574e=(0x0,date_1[_0x36de16(0x12b)])()[_0x36de16(0x157)]('d')['toDate'](),_0x57612c={'answer':(0x0,typeorm_2[_0x36de16(0x1aa)])((0x0,typeorm_2[_0x36de16(0x134)])()),'modelType':model_constant_1[_0x36de16(0x159)][_0x36de16(0x13f)],'createdAt':(0x0,typeorm_2[_0x36de16(0x130)])(_0x4a07d5,_0xd6574e)};_0x2aa890!==undefined&&(_0x57612c[_0x36de16(0x181)]=_0x2aa890);const _0x4c997f=await this[_0x36de16(0x137)][_0x36de16(0x1ae)]({'where':_0x57612c});return _0x4c997f;}async[_0x11b5c8(0x127)](_0x2d1545){const _0x59c2d9=_0x11b5c8,_0x56d0b5={'answer':(0x0,typeorm_2['Not'])((0x0,typeorm_2[_0x59c2d9(0x134)])()),'modelType':model_constant_1[_0x59c2d9(0x159)][_0x59c2d9(0x13f)]};_0x2d1545!==undefined&&(_0x56d0b5[_0x59c2d9(0x181)]=_0x2d1545);const _0x4535d0=await this[_0x59c2d9(0x137)]['count']({'where':_0x56d0b5});return _0x4535d0;}async[_0x11b5c8(0x158)](_0x45fcae){const _0x49eae5=_0x11b5c8,_0x44f354=(0x0,date_1[_0x49eae5(0x12b)])()[_0x49eae5(0x141)]('d')[_0x49eae5(0x145)](),_0x5c117c=(0x0,date_1[_0x49eae5(0x12b)])()[_0x49eae5(0x157)]('d')[_0x49eae5(0x145)](),_0x4b4b80={'status':0x1,'updatedAt':(0x0,typeorm_2[_0x49eae5(0x130)])(_0x44f354,_0x5c117c)};_0x45fcae!==undefined&&(_0x4b4b80['saasId']=_0x45fcae);const _0x14d081=await this[_0x49eae5(0x13e)][_0x49eae5(0x12e)](_0x49eae5(0x153),_0x4b4b80)||0x0;return _0x14d081['toFixed'](0x2);}async[_0x11b5c8(0x176)](_0x41cd0d){const _0x22f302=_0x11b5c8,_0xc5be0={'status':0x1};_0x41cd0d!==undefined&&(_0xc5be0[_0x22f302(0x181)]=_0x41cd0d);const _0x3a3903=await this[_0x22f302(0x13e)][_0x22f302(0x12e)](_0x22f302(0x153),_0xc5be0)||0x0;return _0x3a3903[_0x22f302(0x172)](0x2);}async[_0x11b5c8(0x161)]({days:days=0x7,saasId:_0x4f090b}){const _0x404f6d=_0x11b5c8,_0x55052e=(0x0,utils_1[_0x404f6d(0x188)])(this['clsService']);_0x55052e!==0x0&&(_0x4f090b=_0x55052e);const _0x4ab0dc=await this[_0x404f6d(0x1a2)](days,_0x4f090b),_0x53b75e=await this[_0x404f6d(0x17f)](days,_0x4f090b),_0x1408c0=await this[_0x404f6d(0x164)](days,_0x4f090b);return{'date':_0x4ab0dc['map'](_0x4a7cc0=>_0x4a7cc0[_0x404f6d(0x1a3)]),'chat':_0x4ab0dc[_0x404f6d(0x18d)](_0x5b305b=>_0x5b305b[_0x404f6d(0x162)]),'draw':_0x53b75e[_0x404f6d(0x18d)]((_0x3c6060,_0x1a0abe)=>{const _0x2545eb=_0x404f6d;return _0x3c6060[_0x2545eb(0x162)]+_0x1408c0[_0x1a0abe][_0x2545eb(0x162)];})};}async[_0x11b5c8(0x1a2)](_0x28a549,_0x58cbc2){const _0x142c9d=_0x11b5c8,_0x8cef12=(0x0,date_1[_0x142c9d(0x12b)])()['subtract'](_0x28a549,'d')['startOf']('d')[_0x142c9d(0x145)](),_0x14f0dc=this['chatLogEntity']['createQueryBuilder'](_0x142c9d(0x170))[_0x142c9d(0x198)](_0x142c9d(0x1ab))[_0x142c9d(0x199)]('chatlog.type\x20=\x20:type',{'type':balance_constant_1[_0x142c9d(0x174)]['CHAT_TYPE']})[_0x142c9d(0x15e)]('chatlog.createdAt\x20>=\x20:startDate',{'startDate':_0x8cef12});_0x58cbc2!==undefined&&_0x14f0dc['andWhere']('chatlog.saasId\x20=\x20:saasId',{'saasId':_0x58cbc2});_0x14f0dc[_0x142c9d(0x180)]('date')[_0x142c9d(0x151)](_0x142c9d(0x1a3));const _0x42198d=await _0x14f0dc['getRawMany'](),_0x26782e=[],_0x45e669=_0x8cef12;for(let _0x567033=0x0;_0x567033<_0x28a549;_0x567033++){const _0x28c89e=(0x0,date_1[_0x142c9d(0x16c)])(new Date(_0x45e669),_0x142c9d(0x175)),_0x4e87fe=_0x42198d[_0x142c9d(0x19b)](_0x3ba6b8=>(0x0,date_1[_0x142c9d(0x16c)])(new Date(_0x3ba6b8[_0x142c9d(0x1a3)]),_0x142c9d(0x175))===_0x28c89e)?.[_0x142c9d(0x1ae)]??0x0;_0x4e87fe>0x0?_0x26782e[_0x142c9d(0x19d)]({'date':_0x28c89e,'value':Number(_0x4e87fe)}):_0x26782e['push']({'date':_0x28c89e,'value':0x0}),_0x45e669['setDate'](_0x45e669[_0x142c9d(0x12c)]()+0x1);}return _0x26782e;}async[_0x11b5c8(0x17f)](_0xcbf515,_0x244879){const _0x3cd07a=_0x11b5c8,_0x1243e1=(0x0,date_1[_0x3cd07a(0x12b)])()[_0x3cd07a(0x18b)](_0xcbf515,'d')['startOf']('d')[_0x3cd07a(0x145)](),_0x9462fa=this[_0x3cd07a(0x137)]['createQueryBuilder']('chatlog')[_0x3cd07a(0x198)](_0x3cd07a(0x1ab))[_0x3cd07a(0x199)](_0x3cd07a(0x154),{'type':balance_constant_1['DeductionKey']['PAINT_TYPE']})[_0x3cd07a(0x15e)](_0x3cd07a(0x177),{'startDate':_0x1243e1});_0x244879!==undefined&&_0x9462fa[_0x3cd07a(0x15e)](_0x3cd07a(0x19f),{'saasId':_0x244879});_0x9462fa[_0x3cd07a(0x180)](_0x3cd07a(0x1a3))[_0x3cd07a(0x151)](_0x3cd07a(0x1a3));const _0x3b0a54=await _0x9462fa[_0x3cd07a(0x189)](),_0x2a50bd=[],_0xc75693=_0x1243e1;for(let _0x3d6cdc=0x0;_0x3d6cdc<_0xcbf515;_0x3d6cdc++){const _0x1f0813=(0x0,date_1[_0x3cd07a(0x16c)])(new Date(_0xc75693),_0x3cd07a(0x175)),_0x5768ff=_0x3b0a54[_0x3cd07a(0x19b)](_0xbb0ec7=>(0x0,date_1[_0x3cd07a(0x16c)])(new Date(_0xbb0ec7[_0x3cd07a(0x1a3)]),_0x3cd07a(0x175))===_0x1f0813)?.[_0x3cd07a(0x1ae)]??0x0;_0x5768ff>0x0?_0x2a50bd[_0x3cd07a(0x19d)]({'date':_0x1f0813,'value':Number(_0x5768ff)}):_0x2a50bd[_0x3cd07a(0x19d)]({'date':_0x1f0813,'value':0x0}),_0xc75693[_0x3cd07a(0x142)](_0xc75693[_0x3cd07a(0x12c)]()+0x1);}return _0x2a50bd;}async[_0x11b5c8(0x164)](_0xf764aa,_0x4a95fc){const _0x12b7fe=_0x11b5c8,_0x4427af=(0x0,date_1[_0x12b7fe(0x12b)])()[_0x12b7fe(0x18b)](_0xf764aa,'d')[_0x12b7fe(0x141)]('d')['toDate'](),_0x3e7aca=this[_0x12b7fe(0x19e)][_0x12b7fe(0x12f)](_0x12b7fe(0x149))[_0x12b7fe(0x198)](_0x12b7fe(0x17d))[_0x12b7fe(0x199)](_0x12b7fe(0x1a6),{'status':midjourney_constant_1[_0x12b7fe(0x14f)]['DRAWED']})[_0x12b7fe(0x15e)](_0x12b7fe(0x178),{'startDate':_0x4427af});_0x4a95fc!==undefined&&_0x3e7aca[_0x12b7fe(0x15e)](_0x12b7fe(0x13d),{'saasId':_0x4a95fc});_0x3e7aca[_0x12b7fe(0x180)](_0x12b7fe(0x1a3))[_0x12b7fe(0x151)](_0x12b7fe(0x1a3));const _0x3fc868=await _0x3e7aca[_0x12b7fe(0x189)](),_0x55ff66=[],_0x2584ba=_0x4427af;for(let _0x48c092=0x0;_0x48c092<_0xf764aa;_0x48c092++){const _0x4f2374=(0x0,date_1[_0x12b7fe(0x16c)])(new Date(_0x2584ba),_0x12b7fe(0x175)),_0x1e2530=_0x3fc868[_0x12b7fe(0x19b)](_0x3c5d18=>(0x0,date_1[_0x12b7fe(0x16c)])(new Date(_0x3c5d18[_0x12b7fe(0x1a3)]),_0x12b7fe(0x175))===_0x4f2374)?.['count']??0x0;_0x1e2530>0x0?_0x55ff66[_0x12b7fe(0x19d)]({'date':_0x4f2374,'value':Number(_0x1e2530)}):_0x55ff66[_0x12b7fe(0x19d)]({'date':_0x4f2374,'value':0x0}),_0x2584ba[_0x12b7fe(0x142)](_0x2584ba[_0x12b7fe(0x12c)]()+0x1);}return _0x55ff66;}async['getBaiduStatistics'](_0x10a48b){const _0x5e8c52=_0x11b5c8,_0x1dfd06=(0x0,date_1[_0x5e8c52(0x16c)])(new Date(),_0x5e8c52(0x16a)),_0x1a339c=(0x0,date_1[_0x5e8c52(0x16c)])(new Date(Date[_0x5e8c52(0x1af)]()-Number(_0x10a48b-0x1)*0x18*0x3c*0x3c*0x3e8),_0x5e8c52(0x16a)),_0x4c69dc=_0x5e8c52(0x152),_0x5331b1='overview/getTimeTrendRpt',_0x185782=await this['globalConfigService'][_0x5e8c52(0x1a1)]([_0x5e8c52(0x15f),'baiduSiteId']),_0x2c87c5=_0x185782[_0x5e8c52(0x1a8)],_0x5b3521=_0x185782[_0x5e8c52(0x15f)];if(!_0x2c87c5||!_0x5b3521)return[];if(!_0x2c87c5)throw new common_1[(_0x5e8c52(0x13c))](_0x5e8c52(0x166),common_1[_0x5e8c52(0x155)][_0x5e8c52(0x1b1)]);if(!_0x5b3521)throw new common_1[(_0x5e8c52(0x13c))](_0x5e8c52(0x146),common_1[_0x5e8c52(0x155)][_0x5e8c52(0x1b1)]);const _0x2c20c8=_0x5e8c52(0x18f)+_0x5b3521+_0x5e8c52(0x135)+_0x2c87c5+_0x5e8c52(0x196)+_0x5331b1+'&start_date='+_0x1a339c+_0x5e8c52(0x163)+_0x1dfd06+'&metrics='+_0x4c69dc,_0x5a58d5=await axios_1[_0x5e8c52(0x12b)][_0x5e8c52(0x128)](_0x2c20c8),{error_code:_0x58e984,message:_0x3fcde2}=_0x5a58d5[_0x5e8c52(0x19a)];if(_0x58e984===0x6f)throw new common_1[(_0x5e8c52(0x13c))](_0x3fcde2||_0x5e8c52(0x150),common_1[_0x5e8c52(0x155)]['BAD_REQUEST']);if(_0x58e984&&_0x58e984!==0xc8)throw new common_1[(_0x5e8c52(0x13c))](_0x3fcde2||_0x5e8c52(0x183),common_1[_0x5e8c52(0x155)][_0x5e8c52(0x1b1)]);return _0x5a58d5[_0x5e8c52(0x19a)]['result'];}async[_0x11b5c8(0x13a)](_0x5f195f){const _0x548452=_0x11b5c8,_0x188c14=await this[_0x548452(0x169)][_0x548452(0x17b)]('\x0a\x20\x20\x20\x20\x20\x20SELECT\x0a\x20\x20\x20\x20\x20\x20\x20\x20model\x20AS\x20groupeName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20count(*)\x20AS\x20count\x20\x0a\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20chatlog\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20role\x20=\x20\x27user\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20>=\x20\x27'+_0x5f195f['startTime']+'\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20<=\x20\x27'+_0x5f195f[_0x548452(0x192)]+_0x548452(0x15b)),_0x511a3a=(0x0,date_1[_0x548452(0x12b)])(_0x5f195f[_0x548452(0x1ac)])[_0x548452(0x17a)]((0x0,date_1[_0x548452(0x12b)])(_0x5f195f[_0x548452(0x192)]),_0x548452(0x190)),_0x2eec53=_0x511a3a===0x0?_0x548452(0x14c):_0x548452(0x168),_0xc605c3=await this[_0x548452(0x169)][_0x548452(0x17b)](_0x548452(0x1a4)+_0x2eec53+'\x27\x20)\x20AS\x20groupeName,\x0a\x20\x20\x20\x20\x20\x20\x20\x20COUNT(*)\x20AS\x20count\x20\x0a\x20\x20\x20\x20\x20\x20FROM\x0a\x20\x20\x20\x20\x20\x20\x20\x20chatlog\x20\x0a\x20\x20\x20\x20\x20\x20WHERE\x0a\x20\x20\x20\x20\x20\x20\x20\x20role\x20=\x20\x27user\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AND\x20createdAt\x20>=\x20\x27'+_0x5f195f[_0x548452(0x1ac)]+_0x548452(0x132)+_0x5f195f[_0x548452(0x192)]+_0x548452(0x126));return{'pie':_0x188c14,'line':_0xc605c3};}};StatisticService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_1[_0x11b5c8(0x1a5)])(user_entity_1[_0x11b5c8(0x15c)])),__param(0x1,(0x0,typeorm_1[_0x11b5c8(0x1a5)])(chatLog_entity_1['ChatLogEntity'])),__param(0x2,(0x0,typeorm_1[_0x11b5c8(0x1a5)])(order_entity_1[_0x11b5c8(0x129)])),__param(0x3,(0x0,typeorm_1[_0x11b5c8(0x1a5)])(midjourney_entity_1[_0x11b5c8(0x182)])),__metadata(_0x11b5c8(0x18e),[typeorm_2['Repository'],typeorm_2[_0x11b5c8(0x143)],typeorm_2[_0x11b5c8(0x143)],typeorm_2[_0x11b5c8(0x143)],globalConfig_service_1[_0x11b5c8(0x131)],nestjs_cls_1[_0x11b5c8(0x139)],typeorm_2[_0x11b5c8(0x14b)]])],StatisticService),exports[_0x11b5c8(0x18a)]=StatisticService;