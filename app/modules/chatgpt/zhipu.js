'use strict';const _0x487c27=_0x5f09;(function(_0x2f9fd7,_0x766897){const _0x301846=_0x5f09,_0x31c8ed=_0x2f9fd7();while(!![]){try{const _0x4c5cb9=-parseInt(_0x301846(0x1b2))/0x1+-parseInt(_0x301846(0x1a1))/0x2+-parseInt(_0x301846(0x19b))/0x3+-parseInt(_0x301846(0x1af))/0x4*(parseInt(_0x301846(0x19e))/0x5)+-parseInt(_0x301846(0x1a3))/0x6*(-parseInt(_0x301846(0x1ae))/0x7)+parseInt(_0x301846(0x1c4))/0x8*(parseInt(_0x301846(0x19f))/0x9)+parseInt(_0x301846(0x1a7))/0xa;if(_0x4c5cb9===_0x766897)break;else _0x31c8ed['push'](_0x31c8ed['shift']());}catch(_0x5de25b){_0x31c8ed['push'](_0x31c8ed['shift']());}}}(_0x2926,0x36a6b));function _0x5f09(_0x261009,_0x1f610f){const _0x2926c9=_0x2926();return _0x5f09=function(_0x5f09f2,_0x55066d){_0x5f09f2=_0x5f09f2-0x19b;let _0x5885da=_0x2926c9[_0x5f09f2];return _0x5885da;},_0x5f09(_0x261009,_0x1f610f);}Object[_0x487c27(0x1c7)](exports,_0x487c27(0x1bc),{'value':!![]}),exports[_0x487c27(0x1a8)]=exports[_0x487c27(0x1b3)]=exports['compilerMetaJsonStr']=exports[_0x487c27(0x1c8)]=void 0x0;const axios=require(_0x487c27(0x1be)),jwt=require(_0x487c27(0x1a9));function generateToken(_0x5df320,_0x1bdea8=0x3e8*0x3c*0x3c*0x18*0x168){const _0x45599c=_0x487c27,[_0x5e3234,_0x43f367]=_0x5df320['split']('.'),_0x3ebaab={'api_key':_0x5e3234,'exp':Math['round'](Date['now']())+_0x1bdea8*0x3e8,'timestamp':Math['round'](Date['now']())};return jwt[_0x45599c(0x1a2)](_0x3ebaab,_0x43f367,{'algorithm':_0x45599c(0x1b6),'header':{'alg':_0x45599c(0x1b6),'sign_type':_0x45599c(0x1c5)}});}exports['generateToken']=generateToken;function compilerMetaJsonStr(_0x5672fc){const _0x4eec63=_0x487c27;let _0x293bfa={};try{_0x293bfa=JSON[_0x4eec63(0x1b8)](_0x5672fc);}catch(_0x2603d7){_0x293bfa={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console[_0x4eec63(0x1b4)](_0x4eec63(0x1b1),_0x5672fc);}return _0x293bfa;}exports[_0x487c27(0x1a5)]=compilerMetaJsonStr;function compilerStream(_0x14a36f){const _0x191da1=_0x487c27;console[_0x191da1(0x1ab)](_0x14a36f);if(_0x14a36f[_0x191da1(0x1b5)]===0x3)return{'event':_0x14a36f[0x0][_0x191da1(0x1c0)](_0x191da1(0x1a6),''),'id':_0x14a36f[0x1][_0x191da1(0x1c0)]('id:',''),'is_end':![],'result':_0x14a36f[0x2][_0x191da1(0x1c0)](_0x191da1(0x19d),'')[_0x191da1(0x1aa)]()};if(_0x14a36f['length']===0x4)return{'event':_0x14a36f[0x0][_0x191da1(0x1c0)](_0x191da1(0x1a6),''),'id':_0x14a36f[0x1][_0x191da1(0x1c0)](_0x191da1(0x1bb),''),'result':_0x14a36f[0x2][_0x191da1(0x1c0)](_0x191da1(0x19d),'')[_0x191da1(0x1aa)](),'is_end':!![],'usage':compilerMetaJsonStr(_0x14a36f[0x3]['replace'](_0x191da1(0x1bf),''))?.[_0x191da1(0x1b0)]};}function _0x2926(){const _0x4315ca=['axios','meta:','replace','filter','error:\x20','data','112jQnQDQ','SIGN','toString','defineProperty','generateToken','1154988APTLXR','is_end','data:','1355ruorgc','87858aRZOjY','stream','575068arFcHC','sign','2666406EThWyL','split','compilerMetaJsonStr','event:','6337870uPUvff','sendMessageFromZhipu','jsonwebtoken','trim','log','catch','text','7VNrloa','1684puIbEy','usage','json\x20parse\x20error\x20from\x20zhipu!','204384eUrvRN','compilerStream','error','length','HS256','https://open.bigmodel.cn/api/paas/v3/model-api/','parse','then','/sse-invoke','id:','__esModule','application/json'];_0x2926=function(){return _0x4315ca;};return _0x2926();}exports[_0x487c27(0x1b3)]=compilerStream;async function sendMessageFromZhipu(_0x456afe,{onProgress:_0x321633,key:_0x4a1a44,model:_0x26bf19,temperature:temperature=0.95}){const _0x4a9744=await generateToken(_0x4a1a44);return new Promise((_0x3d3c7c,_0x96ebe3)=>{const _0x4badd5=_0x5f09,_0x2f7594=_0x4badd5(0x1b7)+_0x26bf19+_0x4badd5(0x1ba),_0x486e5c={'method':'POST','url':_0x2f7594,'responseType':_0x4badd5(0x1a0),'headers':{'Content-Type':_0x4badd5(0x1bd),'Authorization':_0x4a9744},'data':{'prompt':_0x456afe,'temperature':temperature}};axios(_0x486e5c)[_0x4badd5(0x1b9)](_0x473e67=>{const _0x29f195=_0x4badd5,_0x3cf0d7=_0x473e67['data'];let _0x377f6b,_0x3306bc='';_0x3cf0d7['on'](_0x29f195(0x1c3),_0x46ce83=>{const _0x24863a=_0x29f195,_0x1139b3=_0x46ce83[_0x24863a(0x1c6)]()[_0x24863a(0x1a4)]('\x0a')[_0x24863a(0x1c1)](_0x3457b2=>_0x3457b2[_0x24863a(0x1aa)]()!=='');console[_0x24863a(0x1ab)](_0x1139b3);const _0x439bd6=compilerStream(_0x1139b3);console[_0x24863a(0x1ab)](_0x439bd6);if(!_0x439bd6)return;const {id:_0x4f0ead,result:_0x1b9e09,is_end:_0x37a41e}=_0x439bd6;_0x1b9e09&&(_0x3306bc+=_0x1b9e09[_0x24863a(0x1aa)]()),_0x37a41e&&(_0x439bd6[_0x24863a(0x19c)]=![],_0x377f6b=_0x439bd6,_0x377f6b[_0x24863a(0x1ad)]=_0x3306bc),_0x321633(_0x439bd6);}),_0x3cf0d7['on']('end',()=>{_0x3d3c7c(_0x377f6b),_0x3306bc='';});})[_0x4badd5(0x1ac)](_0x5657ab=>{const _0x4afe4a=_0x4badd5;console[_0x4afe4a(0x1ab)](_0x4afe4a(0x1c2),_0x5657ab);});});}exports[_0x487c27(0x1a8)]=sendMessageFromZhipu;